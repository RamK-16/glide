import{ab as me,Y as Ce,ac as we,j as ve,ad as Re,ae as Se}from"./image-window-loader-B8cvJCVw.js";import{r as t,R as oe}from"./iframe-VjYuGMsY.js";import{s as De}from"./marked.esm-CZueurBS.js";function ue(e,u,g,o){return Ce(Math.round(u-(e.growOffset??0)),Math.ceil(g),Math.floor(o))}const He=e=>{const[u,g]=t.useState(),[o,M]=t.useState(),[l,X]=t.useState(),[a,w]=t.useState(),[m,H]=t.useState(!1),[P,c]=t.useState(),[C,Y]=t.useState(),[j,ie]=t.useState(),[p,re]=t.useState(!1),[U,ne]=t.useState(),{onHeaderMenuClick:k,onHeaderIndicatorClick:G,getCellContent:se,onColumnMoved:R,onColumnResize:y,onColumnResizeStart:z,onColumnResizeEnd:O,gridRef:q,maxColumnWidth:A,minColumnWidth:b,onRowMoved:N,lockColumns:_,onColumnProposeMove:L,onMouseDown:J,onMouseUp:Q,onItemHovered:B,onDragStart:le,canvasRef:r,setScrollDir:V}=e,W=(y??O??z)!==void 0,{columns:d,selection:Z}=e,s=Z.columns,S=t.useCallback(n=>{const[f,v]=n.location;l!==void 0&&a!==f&&f>=_?(H(!0),w(f)):C!==void 0&&v!==void 0?(re(!0),ie(Math.max(0,v)),V(n.scrollEdge)):o===void 0&&!m&&!p&&(B==null||B(n))},[l,C,a,B,_,o,m,p,V]),i=R!==void 0,F=t.useCallback(n=>{var f;if(n.button===0){const[v,h]=n.location;if(n.kind==="out-of-bounds"&&n.isEdge&&W){const x=(f=q==null?void 0:q.current)==null?void 0:f.getBounds(d.length-1,-1);x!==void 0&&(g(x.x),M(d.length-1))}else if(n.kind==="header"&&v>=_){const x=r==null?void 0:r.current;if(n.isEdge&&W&&x){g(n.bounds.x),M(v);const fe=x.getBoundingClientRect().width/x.offsetWidth,ae=n.bounds.width/fe;z==null||z(d[v],ae,v,ae+(d[v].growOffset??0))}else n.kind==="header"&&i&&(c(n.bounds.x),X(v))}else n.kind==="cell"&&_>0&&v===0&&h!==void 0&&N!==void 0&&(ne(n.bounds.y),Y(h))}J==null||J(n)},[J,W,_,N,q,d,i,z,r]),ee=t.useCallback((n,f)=>{m||p||k==null||k(n,f)},[m,p,k]),$=t.useCallback((n,f)=>{m||p||G==null||G(n,f)},[m,p,G]),K=t.useRef(-1),E=t.useCallback(()=>{K.current=-1,Y(void 0),ie(void 0),ne(void 0),re(!1),X(void 0),w(void 0),c(void 0),H(!1),M(void 0),g(void 0)},[]),D=t.useCallback((n,f)=>{if(n.button===0){if(o!==void 0){if((s==null?void 0:s.hasIndex(o))===!0)for(const h of s){if(h===o)continue;const x=d[h],te=ue(x,K.current,b,A);y==null||y(x,te,h,te+(x.growOffset??0))}const v=ue(d[o],K.current,b,A);if(O==null||O(d[o],v,o,v+(d[o].growOffset??0)),s.hasIndex(o))for(const h of s){if(h===o)continue;const x=d[h],te=ue(x,K.current,b,A);O==null||O(x,te,h,te+(x.growOffset??0))}}E(),l!==void 0&&a!==void 0&&(L==null?void 0:L(l,a))!==!1&&(R==null||R(l,a)),C!==void 0&&j!==void 0&&(N==null||N(C,j))}Q==null||Q(n,f)},[Q,o,l,a,C,j,s,O,d,b,A,y,R,N,E,L]),T=t.useMemo(()=>{if(!(l===void 0||a===void 0)&&l!==a&&(L==null?void 0:L(l,a))!==!1)return{src:l,dest:a}},[l,a,L]),I=t.useCallback(n=>{const f=r==null?void 0:r.current;if(l!==void 0&&P!==void 0)Math.abs(n.clientX-P)>20&&H(!0);else if(C!==void 0&&U!==void 0)Math.abs(n.clientY-U)>20&&re(!0);else if(o!==void 0&&u!==void 0&&f){const h=f.getBoundingClientRect().width/f.offsetWidth,x=(n.clientX-u)/h,te=d[o],fe=ue(te,x,b,A);if(y==null||y(te,fe,o,fe+(te.growOffset??0)),K.current=x,(s==null?void 0:s.first())===o)for(const ae of s){if(ae===o)continue;const he=d[ae],ge=ue(he,K.current,b,A);y==null||y(he,ge,ae,ge+(he.growOffset??0))}}},[l,P,C,U,o,u,d,b,A,y,s,r]),ce=t.useCallback((n,f)=>{if(C===void 0||j===void 0)return se(n,f);let[v,h]=n;return h===j?h=C:(h>j&&(h-=1),h>=C&&(h+=1)),se([v,h],f)},[C,j,se]),de=t.useCallback(n=>{le==null||le(n),n.defaultPrevented()||E()},[E,le]);return t.createElement(me,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawGroupHeader:e.drawGroupHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ce,isResizing:o!==void 0,onHeaderMenuClick:ee,onHeaderIndicatorClick:$,isDragging:m,onItemHovered:S,onDragStart:de,onMouseDown:F,allowResize:W,onMouseUp:D,dragAndDropState:T,onMouseMoveRaw:I,ref:q})};function be(e){const u=t.useRef(null),[g,o]=t.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return t.useLayoutEffect(()=>{const M=X=>{for(const a of X){const{width:w,height:m}=a&&a.contentRect||{};o(H=>H.width===w&&H.height===m?H:{width:w,height:m})}},l=new window.ResizeObserver(M);return u.current&&l.observe(u.current,void 0),()=>{l.disconnect()}},[u.current]),{ref:u,...g}}const Me=(e,u,g)=>{const o=t.useRef(null),M=t.useRef(null),l=t.useRef(null),X=t.useRef(0),a=t.useRef(u);a.current=u;const w=g.current;t.useEffect(()=>{const m=()=>{var c,C;if(M.current===!1&&w!==null){const Y=[w.scrollLeft,w.scrollTop];if(((c=l.current)==null?void 0:c[0])===Y[0]&&((C=l.current)==null?void 0:C[1])===Y[1])if(X.current>10){l.current=null,M.current=null;return}else X.current++;else X.current=0,a.current(Y[0],Y[1]),l.current=Y;o.current=window.setTimeout(m,8.333333333333334)}},H=()=>{M.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},P=c=>{c.touches.length===0&&(M.current=!1,X.current=0,o.current=window.setTimeout(m,8.333333333333334))};if(e&&w!==null){const c=w;return c.addEventListener("touchstart",H),c.addEventListener("touchend",P),()=>{c.removeEventListener("touchstart",H),c.removeEventListener("touchend",P),o.current!==null&&window.clearTimeout(o.current)}}},[e,w])},ye=()=>e=>e.isSafari?"scroll":"auto",xe=De("div")({name:"ScrollRegionStyle",class:"sj2f20c",propsAsIs:!1,vars:{"sj2f20c-0":[ye()]}}),ke=33554400,Ee=5e6;function Te(e){const[u,g]=t.useState(!1),o=typeof window>"u"?null:window,M=t.useRef(0);return ve("touchstart",t.useCallback(()=>{window.clearTimeout(M.current),g(!0)},[]),o,!0,!1),ve("touchend",t.useCallback(l=>{l.touches.length===0&&(M.current=window.setTimeout(()=>g(!1),e))},[e]),o,!0,!1),u}const Ie=e=>{var d,Z;const{children:u,clientHeight:g,scrollHeight:o,scrollWidth:M,update:l,draggable:X,className:a,preventDiagonalScrolling:w=!1,paddingBottom:m=0,paddingRight:H=0,rightElement:P,rightElementProps:c,kineticScrollPerfHack:C=!1,scrollRef:Y,initialSize:j}=e,ie=[],p=(c==null?void 0:c.sticky)??!1,re=(c==null?void 0:c.fill)??!1,U=t.useRef(0),ne=t.useRef(0),k=t.useRef(null),G=typeof window>"u"?1:window.devicePixelRatio,se=t.useRef(G);t.useEffect(()=>{if(se.current!==G){U.current=0,ne.current=0,se.current=G;const s=k.current;s!==null&&N.current(s.scrollLeft,s.scrollTop)}},[G]);const R=t.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),y=t.useRef(null),z=Te(200),[O,q]=t.useState(!0),A=t.useRef(0);t.useLayoutEffect(()=>{if(!O||z||R.current.lockDirection===void 0)return;const s=k.current;if(s===null)return;const[S,i]=R.current.lockDirection;S!==void 0?s.scrollLeft=S:i!==void 0&&(s.scrollTop=i),R.current.lockDirection=void 0},[z,O]);const b=t.useCallback((s,S)=>{var f;const i=k.current;if(i===null)return;S=S??i.scrollTop,s=s??i.scrollLeft;const F=R.current.scrollTop,ee=R.current.scrollLeft,$=s-ee,K=S-F;z&&$!==0&&K!==0&&(Math.abs($)>3||Math.abs(K)>3)&&w&&R.current.lockDirection===void 0&&(R.current.lockDirection=Math.abs($)<Math.abs(K)?[ee,void 0]:[void 0,F]);const E=R.current.lockDirection;s=(E==null?void 0:E[0])??s,S=(E==null?void 0:E[1])??S,R.current.scrollLeft=s,R.current.scrollTop=S;const D=i.clientWidth,T=i.clientHeight,I=S,ce=ne.current-I,de=i.scrollHeight-T;ne.current=I;let n;if(de>0&&o>i.scrollHeight+5)if(Math.abs(ce)>2e3||I===0||I===de){const v=Math.max(0,Math.min(1,I/de)),h=o-T;n=v*h,U.current=n}else U.current-=ce,n=U.current;else n=I,U.current=n;n=Math.max(0,Math.min(n,o-T)),U.current=n,E!==void 0&&(window.clearTimeout(A.current),q(!1),A.current=window.setTimeout(()=>q(!0),200)),l({x:s,y:n,width:D-H,height:T-m,paddingRight:((f=y.current)==null?void 0:f.clientWidth)??0})},[m,H,o,l,w,z]);Me(C&&we.value,b,k);const N=t.useRef(b);N.current=b;const _=t.useRef(void 0),L=t.useRef(!1);t.useLayoutEffect(()=>{L.current?b():L.current=!0},[b,m,H]);const J=t.useCallback(s=>{k.current=s,Y!==void 0&&(Y.current=s)},[Y]);let Q=0,B=0;const le=Math.min(o,ke);for(ie.push(t.createElement("div",{key:Q++,style:{width:M,height:0}}));B<le;){const s=Math.min(Ee,le-B);ie.push(t.createElement("div",{key:Q++,style:{width:0,height:s}})),B+=s}const{ref:r,width:V,height:W}=be(j);return typeof window<"u"&&(((d=_.current)==null?void 0:d.height)!==W||((Z=_.current)==null?void 0:Z.width)!==V)&&(window.setTimeout(()=>N.current(),0),_.current={width:V,height:W}),(V??0)===0||(W??0)===0?t.createElement("div",{ref:r}):t.createElement("div",{ref:r},t.createElement(xe,{isSafari:we.value},t.createElement("div",{className:"dvn-underlay"},u),t.createElement("div",{ref:J,style:_.current,draggable:X,onDragStart:s=>{X||(s.stopPropagation(),s.preventDefault())},className:"dvn-scroller "+(a??""),onScroll:()=>b()},t.createElement("div",{className:"dvn-scroll-inner"+(P===void 0?" dvn-hidden":"")},t.createElement("div",{className:"dvn-stack"},ie),P!==void 0&&t.createElement(t.Fragment,null,!re&&t.createElement("div",{className:"dvn-spacer"}),t.createElement("div",{ref:y,style:{height:W,maxHeight:g-Math.ceil(G%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:H,flexGrow:re?1:void 0,right:p?H??0:void 0,pointerEvents:"auto"}},P))))))},We=e=>{const{columns:u,rows:g,rowHeight:o,headerHeight:M,groupHeaderHeight:l,enableGroups:X,freezeColumns:a,experimental:w,nonGrowWidth:m,clientSize:H,className:P,onVisibleRegionChanged:c,scrollRef:C,preventDiagonalScrolling:Y,rightElement:j,rightElementProps:ie,overscrollX:p,overscrollY:re,initialSize:U,smoothScrollX:ne=!1,smoothScrollY:k=!1,isDraggable:G}=e,{paddingRight:se,paddingBottom:R}=w??{},[y,z]=H,O=oe.useRef(void 0),q=oe.useRef(void 0),A=oe.useRef(void 0),b=oe.useRef(void 0),N=m+Math.max(0,p??0),_=Re(u,a??0),L=X?Se(l,_):0;let J=M+L;if(typeof o=="number")J+=g*o;else for(let r=0;r<g;r++)J+=o(r);re!==void 0&&(J+=re);const Q=oe.useRef(void 0),B=oe.useCallback(()=>{var K,E;if(Q.current===void 0)return;const r={...Q.current};let V=0,W=r.x<0?-r.x:0,d=0,Z=0;r.x=r.x<0?0:r.x;let s=0;for(let D=0;D<a;D++)s+=u[D].width;for(const D of u){const T=V-s;if(r.x>=T+D.width)V+=D.width,Z++,d++;else if(r.x>T)V+=D.width,ne?W+=T-r.x:Z++,d++;else if(r.x+r.width>T)V+=D.width,d++;else break}let S=0,i=0,F=0;if(typeof o=="number")k?(i=Math.floor(r.y/o),S=i*o-r.y):i=Math.ceil(r.y/o),F=Math.ceil(r.height/o)+i,S<0&&F++;else{let D=0;for(let T=0;T<g;T++){const I=o(T),ce=D+(k?0:I/2);if(r.y>=D+I)D+=I,i++,F++;else if(r.y>ce)D+=I,k?S+=ce-r.y:i++,F++;else if(r.y+r.height>I/2+D)D+=I,F++;else break}}i=Math.max(0,Math.min(i,g-1)),F=Math.max(i,Math.min(F,g));const ee={x:Z,y:i,width:d-Z,height:F-i},$=O.current;($===void 0||$.y!==ee.y||$.x!==ee.x||$.height!==ee.height||$.width!==ee.width||q.current!==W||A.current!==S||r.width!==((K=b.current)==null?void 0:K[0])||r.height!==((E=b.current)==null?void 0:E[1]))&&(c==null||c({x:Z,y:i,width:d-Z,height:F-i},r.width,r.height,r.paddingRight??0,W,S),O.current=ee,q.current=W,A.current=S,b.current=[r.width,r.height])},[u,o,g,c,a,ne,k]),le=oe.useCallback(r=>{Q.current=r,B()},[B]);return oe.useEffect(()=>{B()},[B]),oe.createElement(Ie,{scrollRef:C,className:P,kineticScrollPerfHack:w==null?void 0:w.kineticScrollPerfHack,preventDiagonalScrolling:Y,draggable:G===!0||typeof G=="string",scrollWidth:N+(se??0),scrollHeight:J+(R??0),clientHeight:z,rightElement:j,paddingBottom:R,paddingRight:se,rightElementProps:ie,update:le,initialSize:U},oe.createElement(He,{eventTargetRef:C,width:y,height:z,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawGroupHeader:e.drawGroupHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator,setScrollDir:e.setScrollDir}))};export{We as G};
