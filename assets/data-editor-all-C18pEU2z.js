const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-DSr3v8BW.js","./iframe-VjYuGMsY.js","./preload-helper-C1FmrZbK.js","./index-oW5Svp7Q.js","./image-window-loader-B8cvJCVw.js","./marked.esm-CZueurBS.js","./image-window-loader-BbjjDkga.css","./scrolling-data-grid-Dlt80JY1.js","./scrolling-data-grid-wZ406GJK.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var Ql=Object.defineProperty;var ei=(e,o,l)=>o in e?Ql(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l;var hn=(e,o,l)=>ei(e,typeof o!="symbol"?o+"":o,l);import{r as i,g as pn,R as he}from"./iframe-VjYuGMsY.js";import{_ as ti}from"./preload-helper-C1FmrZbK.js";import{k as Fo,l as lr,_ as Cr,n as oi,o as ni,q as ri,s as li,t as ii,v as si,w as ci,G as Z,x as Wo,y as Ko,C as Y,z as wr,A as ai,B as gt,D as ui,E as di,F as gn,H as ir,I as Ao,J as fi,K as hi,L as gi,M as vi,N as Pt,O as sr,P as cr,Q as mi,R as Go,S as to,T as Ci,U as wi,V as pi,W as bi,X as yi,Y as kt,Z as ar,f as Nt,$ as oo,a0 as xi,a1 as Mi,a2 as ur,a3 as Ri,j as vn,a4 as ki,a5 as Si,a6 as Ti,a7 as zi,a8 as dr,a9 as Ei,aa as Li}from"./image-window-loader-B8cvJCVw.js";import{G as Ii}from"./scrolling-data-grid-Dlt80JY1.js";import{s as bn}from"./marked.esm-CZueurBS.js";const Cn=150;function Hi(e,o,l,c){var y;const m=c(o);return((y=m==null?void 0:m.measure)==null?void 0:y.call(m,e,o,l))??Cn}function pr(e,o,l,c,m,y,z,p,R){let E=0;const v=m===void 0?[]:m.map(N=>{const _=Hi(e,N[c],o,R);return E=Math.max(E,_),_});if(v.length>5&&p){E=0;let N=0;for(const B of v)N+=B;const _=N/v.length;for(let B=0;B<v.length;B++)v[B]>=_*2?v[B]=0:E=Math.max(E,v[B])}const M=e.font;e.font=o.headerFontFull,E=Math.max(E,e.measureText(l.title).width+o.cellHorizontalPadding*2+(l.icon===void 0?0:28)),e.font=M;const S=Math.max(Math.ceil(y),Math.min(Math.floor(z),Math.ceil(E)));return{...l,width:S}}function Di(e,o,l,c,m,y,z,p,R){const E=i.useRef(o),v=i.useRef(l),M=i.useRef(z);E.current=o,v.current=l,M.current=z;const[S,N]=i.useMemo(()=>{if(typeof window>"u")return[null,null];const L=document.createElement("canvas");return L.style.display="none",L.style.opacity="0",L.style.position="fixed",[L,L.getContext("2d",{alpha:!1})]},[]);i.useLayoutEffect(()=>(S&&document.documentElement.append(S),()=>{S==null||S.remove()}),[S]);const _=i.useRef({}),B=i.useRef(void 0),[Ce,U]=i.useState();return i.useLayoutEffect(()=>{const L=v.current;if(L===void 0||e.every(Fo))return;let O=Math.max(1,10-Math.floor(e.length/1e4)),ye=0;O<E.current&&O>1&&(O--,ye=1);const J={x:0,y:0,width:e.length,height:Math.min(E.current,O)},ge={x:0,y:E.current-1,width:e.length,height:1};(async()=>{const Q=L(J,R.signal),ne=ye>0?L(ge,R.signal):void 0;let ee;typeof Q=="object"?ee=Q:ee=await lr(Q),ne!==void 0&&(typeof ne=="object"?ee=[...ee,...ne]:ee=[...ee,...await lr(ne)]),B.current=e,U(ee)})()},[R.signal,e]),i.useMemo(()=>{let O=e.every(Fo)?e:N===null?e.map(X=>Fo(X)?X:{...X,width:Cn}):(N.font=M.current.baseFontFull,e.map((X,Q)=>{if(Fo(X))return X;if(_.current[X.id]!==void 0)return{...X,width:_.current[X.id]};if(Ce===void 0||B.current!==e||X.id===void 0)return{...X,width:Cn};const ne=pr(N,z,X,Q,Ce,m,y,!0,p);return _.current[X.id]=ne.width,ne})),ye=0,J=0;const ge=[];for(const[X,Q]of O.entries())ye+=Q.width,Q.grow!==void 0&&Q.grow>0&&(J+=Q.grow,ge.push(X));if(ye<c&&ge.length>0){const X=[...O],Q=c-ye;let ne=Q;for(let ee=0;ee<ge.length;ee++){const ze=ge[ee],St=(O[ze].grow??0)/J,we=ee===ge.length-1?ne:Math.min(ne,Math.floor(Q*St));X[ze]={...O[ze],growOffset:we,width:O[ze].width+we},ne-=we}O=X}return{sizedColumns:O,nonGrowWidth:ye}},[c,e,N,Ce,z,m,y,p])}function $i(e,o,l,c){for(var m=e.length,y=l+(c?1:-1);c?y--:++y<m;)if(o(e[y],y,e))return y;return-1}var Fi=$i;function Ai(e){return e!==e}var Gi=Ai;function Pi(e,o,l){for(var c=l-1,m=e.length;++c<m;)if(e[c]===o)return c;return-1}var Ni=Pi,Oi=Fi,Wi=Gi,Ki=Ni;function _i(e,o,l){return o===o?Ki(e,o,l):Oi(e,Wi,l)}var Ui=_i,Vi=Ui;function Bi(e,o){var l=e==null?0:e.length;return!!l&&Vi(e,o,0)>-1}var Xi=Bi;function Yi(e,o,l){for(var c=-1,m=e==null?0:e.length;++c<m;)if(l(o,e[c]))return!0;return!1}var qi=Yi;function ji(){}var br=ji;const Oc=pn(br);var mn=oi,Zi=br,Ji=Cr,Qi=1/0,es=mn&&1/Ji(new mn([,-0]))[1]==Qi?function(e){return new mn(e)}:Zi,ts=es,os=ni,ns=Xi,rs=qi,ls=ri,is=ts,ss=Cr,cs=200;function as(e,o,l){var c=-1,m=ns,y=e.length,z=!0,p=[],R=p;if(l)z=!1,m=rs;else if(y>=cs){var E=o?null:is(e);if(E)return ss(E);z=!1,m=ls,R=new os}else R=o?[]:p;e:for(;++c<y;){var v=e[c],M=o?o(v):v;if(v=l||v!==0?v:0,z&&M===M){for(var S=R.length;S--;)if(R[S]===M)continue e;o&&R.push(M),p.push(v)}else m(R,M,l)||(R!==p&&R.push(M),p.push(v))}return p}var us=as,ds=us;function fs(e){return e&&e.length?ds(e):[]}var hs=fs;const gs=pn(hs);var fr=li,vs=si,ms=ii,hr=fr?fr.isConcatSpreadable:void 0;function Cs(e){return ms(e)||vs(e)||!!(hr&&e&&e[hr])}var ws=Cs,ps=ci,bs=ws;function yr(e,o,l,c,m){var y=-1,z=e.length;for(l||(l=bs),m||(m=[]);++y<z;){var p=e[y];o>0&&l(p)?o>1?yr(p,o-1,l,c,m):ps(m,p):c||(m[m.length]=p)}return m}var ys=yr,xs=ys;function Ms(e){var o=e==null?0:e.length;return o?xs(e,1):[]}var Rs=Ms;const gr=pn(Rs),j='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',ks=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}<rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},Ss=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}<rect x="2" y="2" width="16" height="16" rx="4" fill="${l}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},Ts=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},zs=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Es=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${l}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},xr=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},Ls=e=>{const o=e.bgColor;return`${j}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Is=xr,Hs=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},Ds=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},$s=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Fs=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${l}"/>
  </svg>`},As=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Gs=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Ps=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Ns=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Os=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${l}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${l}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Ws=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${l}"/>
</svg>`},Ks=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},_s=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Us=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Vs=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Bs=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Xs=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Ys=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${j}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},qs=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},js=e=>{const o=e.fgColor,l=e.bgColor;return`${j}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Zs=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Js=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Qs={headerRowID:ks,headerNumber:Ts,headerCode:Ss,headerString:zs,headerBoolean:Es,headerAudioUri:Is,headerVideoUri:Hs,headerEmoji:Ds,headerImage:$s,headerUri:xr,headerPhone:Fs,headerMarkdown:As,headerDate:Gs,headerTime:Ps,headerEmail:Ns,headerReference:Os,headerIfThenElse:Ws,headerSingleValue:Ks,headerLookup:_s,headerTextTemplate:Us,headerMath:Vs,headerRollup:Bs,headerJoinStrings:Xs,headerSplitString:Ys,headerGeoDistance:qs,headerArray:js,rowOwnerOverlay:Zs,protectedColumnOverlay:Js,renameIcon:Ls},ec=bn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),tc=i.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},i.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),oc=i.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},i.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),nc=i.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},i.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),rc=10,lc=e=>{const{canvasRef:o,cellYOffset:l,rows:c,columns:m,searchInputRef:y,searchValue:z,searchResults:p,onSearchValueChange:R,getCellsForSelection:E,onSearchResultsChanged:v,showSearch:M=!1,onSearchClose:S}=e,[N]=i.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[_,B]=i.useState(""),Ce=z??_,U=i.useCallback(F=>{B(F),R==null||R(F)},[R]),[L,O]=i.useState(),ye=i.useRef(L);ye.current=L,i.useEffect(()=>{p!==void 0&&(p.length>0?O(F=>({rowsSearched:c,results:p.length,selectedIndex:(F==null?void 0:F.selectedIndex)??-1})):O(void 0))},[c,p]);const J=i.useRef(void 0);J.current===void 0&&(J.current=new AbortController);const ge=i.useRef(void 0),[X,Q]=i.useState([]),ne=p??X,ee=i.useCallback(()=>{ge.current!==void 0&&(window.cancelAnimationFrame(ge.current),ge.current=void 0),J.current!==void 0&&J.current.abort(),J.current=new AbortController},[]),ze=i.useRef(l);ze.current=l;const St=i.useCallback(F=>{const re=new RegExp(F.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let se=ze.current,He=Math.min(10,c),De=0;O(void 0),Q([]);const Ye=[],no=async()=>{var rt;if(E===void 0)return;const _o=performance.now(),Uo=c-De;let qe=E({x:0,y:se,width:m.length,height:Math.min(He,Uo,c-se)},J.current.signal);typeof qe=="function"&&(qe=await qe());let ro=!1;for(const[Ct,je]of qe.entries())for(const[xe,ce]of je.entries()){let Ze;switch(ce.kind){case Z.Text:case Z.Number:Ze=ce.displayData;break;case Z.Uri:case Z.Markdown:Ze=ce.data;break;case Z.Boolean:Ze=typeof ce.data=="boolean"?ce.data.toString():void 0;break;case Z.Image:case Z.Bubble:Ze=ce.data.join("üê≥");break;case Z.Custom:Ze=ce.copyData;break}Ze!==void 0&&re.test(Ze)&&(Ye.push([xe,Ct+se]),ro=!0)}const Vo=performance.now();ro&&Q([...Ye]),De+=qe.length,Wo(De<=c);const Wt=((rt=ye.current)==null?void 0:rt.selectedIndex)??-1;O({results:Ye.length,rowsSearched:De,selectedIndex:Wt}),v==null||v(Ye,Wt),se+He>=c?se=0:se+=He;const ot=Vo-_o,nt=Math.max(ot,1),mt=rc/nt;He=Math.ceil(He*mt),De<c&&Ye.length<1e3&&(ge.current=window.requestAnimationFrame(no))};ee(),ge.current=window.requestAnimationFrame(no)},[ee,m.length,E,v,c]),we=i.useCallback(()=>{var F;S==null||S(),O(void 0),Q([]),v==null||v([],-1),ee(),(F=o==null?void 0:o.current)==null||F.focus()},[ee,o,S,v]),tt=i.useCallback(F=>{U(F.target.value),p===void 0&&(F.target.value===""?(O(void 0),Q([]),ee()):St(F.target.value))},[St,ee,U,p]);i.useEffect(()=>{y.current!==null&&(U(""),O(void 0),X.length>0&&(Q([]),v==null||v([],-1)),M?y.current.focus({preventScroll:!0}):ee())},[M,y]);const Tt=i.useCallback(F=>{var se;if((se=F==null?void 0:F.stopPropagation)==null||se.call(F),L===void 0||L.results===0)return;const re=(L.selectedIndex+1)%L.results;O({...L,selectedIndex:re}),v==null||v(ne,re)},[L,v,ne]),vt=i.useCallback(F=>{var se;if((se=F==null?void 0:F.stopPropagation)==null||se.call(F),L===void 0||L.results===0)return;let re=(L.selectedIndex-1)%L.results;re<0&&(re+=L.results),O({...L,selectedIndex:re}),v==null||v(ne,re)},[v,ne,L]),Ke=i.useCallback(F=>{(F.ctrlKey||F.metaKey)&&F.nativeEvent.code==="KeyF"||F.key==="Escape"?(we(),F.stopPropagation(),F.preventDefault()):F.key==="Enter"&&(F.shiftKey?vt():Tt())},[we,Tt,vt]);i.useEffect(()=>()=>{ee()},[ee]);const[Ge,Ot]=i.useState(!1);i.useEffect(()=>{if(M)Ot(!0);else{const F=setTimeout(()=>Ot(!1),150);return()=>clearTimeout(F)}},[M]);const _e=i.useMemo(()=>{if(!M&&!Ge)return null;let F;L!==void 0&&(F=L.results>=1e3?"over 1000":`${L.results} result${L.results!==1?"s":""}`,L.selectedIndex>=0&&(F=`${L.selectedIndex+1} of ${F}`));const re=De=>{De.stopPropagation()},He={width:`${c>0?Math.floor(((L==null?void 0:L.rowsSearched)??0)/c*100):0}%`};return i.createElement(ec,{className:"gdg-search-bar"+(M?"":" out"),onMouseDown:re,onMouseMove:re,onMouseUp:re,onClick:re},i.createElement("div",{className:"gdg-search-bar-inner"},i.createElement("input",{id:N,"aria-hidden":!M,"data-testid":"search-input",ref:y,onChange:tt,value:Ce,tabIndex:M?void 0:-1,onKeyDownCapture:Ke}),i.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:vt,disabled:((L==null?void 0:L.results)??0)===0},tc),i.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:Tt,disabled:((L==null?void 0:L.results)??0)===0},oc),S!==void 0&&i.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!M,"data-testid":"search-close-button",tabIndex:M?void 0:-1,onClick:we},nc)),L!==void 0?i.createElement(i.Fragment,null,i.createElement("div",{className:"gdg-search-status"},i.createElement("div",{"data-testid":"search-result-area"},F)),i.createElement("div",{className:"gdg-search-progress",style:He})):i.createElement("div",{className:"gdg-search-status"},i.createElement("label",{htmlFor:N},"Type to search")))},[M,Ge,L,c,N,y,tt,Ce,Ke,vt,Tt,S,we]);return i.createElement(i.Fragment,null,i.createElement(Ii,{prelightCells:ne,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,drawGroupHeader:e.drawGroupHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator,setScrollDir:e.setScrollDir}),_e)};class ic extends i.PureComponent{constructor(){super(...arguments);hn(this,"wrapperRef",i.createRef());hn(this,"clickOutside",l=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(l))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(l.target)){let c=l.target;for(;c!==null;){if(c.classList.contains("click-outside-ignore"))return;c=c.parentElement}this.props.onClickOutside()}})}componentDidMount(){const l=this.props.customEventTarget??document;l.addEventListener("pointerdown",this.clickOutside,!0),l.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const l=this.props.customEventTarget??document;l.removeEventListener("pointerdown",this.clickOutside,!0),l.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:l,isOutsideClick:c,customEventTarget:m,...y}=this.props;return i.createElement("div",{...y,ref:this.wrapperRef},this.props.children)}}const sc=()=>e=>Math.max(16,e.targetHeight-10),cc=bn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[sc(),"px"]}}),ac=e=>{const{bounds:o,group:l,onClose:c,canvasBounds:m,onFinish:y}=e,[z,p]=he.useState(l);return he.createElement(ic,{style:{position:"absolute",left:o.x-m.left+1,top:o.y-m.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:c},he.createElement(cc,{targetHeight:o.height,"data-testid":"group-rename-input",value:z,onBlur:c,onFocus:R=>R.target.setSelectionRange(0,z.length),onChange:R=>p(R.target.value),onKeyDown:R=>{R.key==="Enter"?y(z):R.key==="Escape"&&c()},autoFocus:!0}))};function uc(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function G(e,o,l){const c=Mr(e,o);return c&&(l.didMatch=!0),c}function Mr(e,o){if(e.length===0)return!1;if(e.includes("|")){const R=e.split("|");for(const E of R)if(Mr(E,o))return!0;return!1}let l=!1,c=!1,m=!1,y=!1;const z=e.split("+"),p=z.pop();if(!uc(p,o))return!1;if(z[0]==="any")return!0;for(const R of z)switch(R){case"ctrl":l=!0;break;case"shift":c=!0;break;case"alt":m=!0;break;case"meta":y=!0;break;case"primary":Ko.value?y=!0:l=!0;break}return o.altKey===m&&o.ctrlKey===l&&o.shiftKey===c&&o.metaKey===y}function dc(e,o,l,c,m,y,z){const p=he.useCallback((v,M,S,N)=>{var O;(y==="cell"||y==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!z&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const _=l==="mixed"&&(S||N==="drag")||l==="additive",B=(c==="mixed"||c==="additive")&&_,Ce=(m==="mixed"||m==="additive")&&_;let U={current:v===void 0?void 0:{...v,rangeStack:N==="drag"?((O=e.current)==null?void 0:O.rangeStack)??[]:[]},columns:B?e.columns:Y.empty(),rows:Ce?e.rows:Y.empty()};S&&(y==="multi-rect"||y==="multi-cell")&&U.current!==void 0&&e.current!==void 0&&(U={...U,current:{...U.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(U,M)},[c,e,l,y,z,m,o]),R=he.useCallback((v,M,S)=>{v=v??e.rows,M!==void 0&&(v=v.add(M));let N;if(m==="exclusive"&&v.length>0)N={current:void 0,columns:Y.empty(),rows:v};else{const _=S&&l==="mixed"||l==="additive",B=S&&c==="mixed"||c==="additive";N={current:_?e.current:void 0,columns:B?e.columns:Y.empty(),rows:v}}o(N,!1)},[c,e,l,m,o]),E=he.useCallback((v,M,S)=>{v=v??e.columns,M!==void 0&&(v=v.add(M));let N;if(c==="exclusive"&&v.length>0)N={current:void 0,rows:Y.empty(),columns:v};else{const _=S&&l==="mixed"||l==="additive",B=S&&m==="mixed"||m==="additive";N={current:_?e.current:void 0,rows:B?e.rows:Y.empty(),columns:v}}o(N,!1)},[c,e,l,m,o]);return[p,R,E]}function fc(e,o,l,c,m){const y=i.useCallback(E=>{if(e===!0){const v=[];for(let M=E.y;M<E.y+E.height;M++){const S=[];for(let N=E.x;N<E.x+E.width;N++)N<0||M>=m?S.push({kind:Z.Loading,allowOverlay:!1}):S.push(o([N,M]));v.push(S)}return v}return(e==null?void 0:e(E,c.signal))??[]},[c.signal,o,e,m]),z=e!==void 0?y:void 0,p=i.useCallback(E=>{if(z===void 0)return[];const v={...E,x:E.x-l};if(v.x<0){v.x=0,v.width--;const M=z(v,c.signal);return typeof M=="function"?async()=>(await M()).map(S=>[{kind:Z.Loading,allowOverlay:!1},...S]):M.map(S=>[{kind:Z.Loading,allowOverlay:!1},...S])}return z(v,c.signal)},[c.signal,z,l]);return[e!==void 0?p:void 0,z]}function vr(e){return typeof e=="string"?e:`${e}px`}const hc=()=>e=>e.innerWidth,gc=()=>e=>e.innerHeight,vc=bn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[hc()],"w2q57ts-1":[gc()]}}),mc=e=>{const{inWidth:o,inHeight:l,children:c,...m}=e;return i.createElement(vc,{innerHeight:vr(l),innerWidth:vr(o),...m},c)},Cc=2,wc=1300;function pc(e,o,l){const c=he.useRef(0),[m,y]=e??[0,0];he.useEffect(()=>{if(m===0&&y===0){c.current=0;return}let z=!1,p=0;const R=E=>{var v;if(!z){if(p===0)p=E;else{const M=E-p;c.current=Math.min(1,c.current+M/wc);const S=c.current**1.618*M*Cc;(v=o.current)==null||v.scrollBy(m*S,y*S),p=E,l==null||l()}window.requestAnimationFrame(R)}};return window.requestAnimationFrame(R),()=>{z=!0}},[o,m,y,l])}function bc({rowHeight:e,headerHeight:o,groupHeaderHeight:l,theme:c,overscrollX:m,overscrollY:y,scaleToRem:z,remSize:p}){const[R,E,v,M,S,N]=he.useMemo(()=>{if(!z||p===16)return[e,o,l,c,m,y];const _=p/16,B=e,Ce=wr(),U=Array.isArray(l)?l.map(L=>Math.ceil(L*_)):Math.ceil(l*_);return[typeof B=="number"?B*_:L=>Math.ceil(B(L)*_),Math.ceil(o*_),U,{...c,headerIconSize:((c==null?void 0:c.headerIconSize)??Ce.headerIconSize)*_,cellHorizontalPadding:((c==null?void 0:c.cellHorizontalPadding)??Ce.cellHorizontalPadding)*_,cellVerticalPadding:((c==null?void 0:c.cellVerticalPadding)??Ce.cellVerticalPadding)*_},Math.ceil((m??0)*_),Math.ceil((y??0)*_)]},[l,o,m,y,p,e,z,c]);return{rowHeight:R,headerHeight:E,groupHeaderHeight:v,theme:M,overscrollX:S,overscrollY:N}}const ht={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function P(e,o){return e===!0?o:e===!1?"":e}function mr(e){const o=Ko.value;return{activateCell:P(e.activateCell," |Enter|shift+Enter"),clear:P(e.clear,"any+Escape"),closeOverlay:P(e.closeOverlay,"any+Escape"),acceptOverlayDown:P(e.acceptOverlayDown,"Enter"),acceptOverlayUp:P(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:P(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:P(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:P(e.delete,o?"Backspace|Delete":"Delete"),downFill:P(e.downFill,"primary+_68"),scrollToSelectedCell:P(e.scrollToSelectedCell,"primary+Enter"),goDownCell:P(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:P(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:P(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:P(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:P(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:P(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:P(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:P(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:P(e.goToFirstCell,"primary+Home"),goToFirstColumn:P(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:P(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:P(e.goToLastCell,"primary+End"),goToLastColumn:P(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:P(e.goToLastRow,"primary+ArrowDown"),goToNextPage:P(e.goToNextPage,"PageDown"),goToPreviousPage:P(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:P(e.rightFill,"primary+_82"),search:P(e.search,"primary+f"),selectAll:P(e.selectAll,"primary+a"),selectColumn:P(e.selectColumn,"ctrl+ "),selectGrowDown:P(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:P(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:P(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:P(e.selectGrowUp,"shift+ArrowUp"),selectRow:P(e.selectRow,"shift+ "),selectToFirstCell:P(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:P(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:P(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:P(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:P(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:P(e.selectToLastRow,"primary+shift+ArrowDown")}}function yc(e){const o=ai(e);return he.useMemo(()=>{if(o===void 0)return mr(ht);const l={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ht.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ht.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ht.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ht.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ht.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ht.selectToLastCell};return mr({...ht,...l})},[o])}function xc(e){function o(c,m,y){if(typeof c=="number")return{headerIndex:c,isCollapsed:!1,depth:m,path:y};const z={headerIndex:c.headerIndex,isCollapsed:c.isCollapsed,depth:m,path:y};return c.subGroups!==void 0&&(z.subGroups=c.subGroups.map((p,R)=>o(p,m+1,[...y,R])).sort((p,R)=>p.headerIndex-R.headerIndex)),z}return e.map((c,m)=>o(c,0,[m])).sort((c,m)=>c.headerIndex-m.headerIndex)}function yn(e,o){const l=[];function c(p,R,E=!1){let v=R!==null?R-p.headerIndex:o-p.headerIndex;if(p.subGroups!==void 0&&(v=p.subGroups[0].headerIndex-p.headerIndex),v--,l.push({rowIndex:-1,headerIndex:p.headerIndex,contentIndex:-1,skip:E,isCollapsed:p.isCollapsed,depth:p.depth,path:p.path,rows:v}),p.subGroups)for(let M=0;M<p.subGroups.length;M++){const S=M<p.subGroups.length-1?p.subGroups[M+1].headerIndex:R;c(p.subGroups[M],S,E||p.isCollapsed)}}const m=xc(e.groups);for(let p=0;p<m.length;p++){const R=p<m.length-1?m[p+1].headerIndex:null;c(m[p],R)}let y=0,z=0;for(const p of l)p.contentIndex=z,z+=p.rows,p.rowIndex=y,y+=p.isCollapsed?1:p.rows+1;return l.filter(p=>p.skip===!1).map(p=>{const{skip:R,...E}=p;return E})}function wn(e,o){if(o===void 0||yn.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let l=e;for(const c of o){if(l===0)return{path:[...c.path,-1],originalIndex:c.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:c.rows};if(c.isCollapsed)l--;else{if(l<=c.rows)return{path:[...c.path,l-1],originalIndex:c.headerIndex+l,isGroupHeader:!1,groupIndex:l-1,contentIndex:c.contentIndex+l-1,groupRows:c.rows};l=l-c.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Mc(e,o,l,c){const m=he.useMemo(()=>e===void 0?void 0:yn(e,o),[e,o]),y=he.useMemo(()=>m==null?void 0:m.reduce((v,M)=>(v[M.rowIndex]=M,v),{}),[m]),z=he.useMemo(()=>m===void 0?o:m.reduce((v,M)=>v+(M.isCollapsed?1:M.rows+1),0),[m,o]),p=he.useMemo(()=>e===void 0||typeof l=="number"&&e.height===l?l:v=>y!=null&&y[v]?e.height:typeof l=="number"?l:l(v),[y,e,l]),R=he.useCallback(v=>{if(m===void 0)return v;let M=v;for(const S of m){if(M===0)return;if(M--,!S.isCollapsed){if(M<S.rows)return S.contentIndex+M;M-=S.rows}}return v},[m]),E=gt(c??(e==null?void 0:e.themeOverride),he.useCallback(v=>{if(e===void 0)return c==null?void 0:c(v,v,v);if(c===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:M,contentIndex:S,groupIndex:N}=wn(v,m);return M?e.themeOverride:c==null?void 0:c(v,N,S)},[m,c,e]));return e===void 0?{rowHeight:p,rows:o,rowNumberMapper:R,getRowThemeOverride:E}:{rowHeight:p,rows:z,rowNumberMapper:R,getRowThemeOverride:E}}function Rc(e,o){const l=he.useMemo(()=>e===void 0?void 0:yn(e,o),[e,o]);return{getRowGroupingForPath:kr,updateRowGroupingByPath:Rr,mapper:he.useCallback(c=>{if(typeof c=="number")return wn(c,l);const m=wn(c[1],l);return{...m,originalIndex:[c[0],m.originalIndex]}},[l])}}function Rr(e,o,l){const[c,...m]=o;return m[0]===-1?e.map((y,z)=>z===c?{...y,...l}:y):e.map((y,z)=>z===c?{...y,subGroups:Rr(y.subGroups??[],m,l)}:y)}function kr(e,o){const[l,...c]=o;return c[0]===-1?e[l]:kr(e[l].subGroups??[],c)}function kc(e,o){const[l]=i.useState(()=>({value:e,callback:o,facade:{get current(){return l.value},set current(c){const m=l.value;m!==c&&(l.value=c,l.callback(c,m))}}}));return l.callback=o,l.facade}function Sc(e,o,l,c,m){const[y,z]=i.useMemo(()=>[o!==void 0&&typeof l=="number"?Math.floor(o/l):0,o!==void 0&&typeof l=="number"?-(o%l):0],[o,l]),p=i.useMemo(()=>({x:c.current.x,y,width:c.current.width??1,height:c.current.height??1,ty:z}),[c,z,y]),[R,E,v]=ui(p),M=i.useRef(m);M.current=m;const S=kc(null,B=>{B!==null&&o!==void 0?B.scrollTop=o:B!==null&&e!==void 0&&(B.scrollLeft=e)}),N=(R.height??1)>1;i.useLayoutEffect(()=>{if(o!==void 0&&S.current!==null&&N){if(S.current.scrollTop===o)return;S.current.scrollTop=o,S.current.scrollTop!==o&&v(),M.current()}},[o,N,v,S]);const _=(R.width??1)>1;return i.useLayoutEffect(()=>{if(e!==void 0&&S.current!==null&&_){if(S.current.scrollLeft===e)return;S.current.scrollLeft=e,S.current.scrollLeft!==e&&v(),M.current()}},[e,_,v,S]),{visibleRegion:R,setVisibleRegion:E,scrollRef:S}}const Tc=i.lazy(async()=>await ti(()=>import("./data-grid-overlay-editor-DSr3v8BW.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url));let zc=0;function Ec(e){return gs(gr(gr(e).filter(o=>o.span!==void 0).map(o=>{var l,c;return Nt((((l=o.span)==null?void 0:l[0])??0)+1,(((c=o.span)==null?void 0:c[1])??0)+1)})))}function Po(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(l=>({...l,x:l.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const No={kind:Z.Loading,allowOverlay:!1},Oo={columns:Y.empty(),rows:Y.empty(),current:void 0},Lc=(e,o)=>{var or,nr,rr;const[l,c]=i.useState(Oo),[m,y]=i.useState(),z=i.useRef(null),p=i.useRef(null),[R,E]=i.useState(),v=i.useRef(void 0),M=typeof window>"u"?null:window,{imageEditorOverride:S,getRowThemeOverride:N,markdownDivCreateNode:_,width:B,height:Ce,columns:U,rows:L,getCellContent:O,onCellClicked:ye,onCellActivated:J,onFillPattern:ge,onFinishedEditing:X,coercePasteValue:Q,drawHeader:ne,drawGroupHeader:ee,drawCell:ze,editorBloom:St,onHeaderClicked:we,onColumnProposeMove:tt,rangeSelectionColumnSpanning:Tt=!0,spanRangeBehavior:vt="default",onGroupHeaderClicked:Ke,onCellContextMenu:Ge,className:Ot,onHeaderContextMenu:_e,getCellsForSelection:F,onGroupHeaderContextMenu:re,onGroupHeaderRenamed:se,onCellEdited:He,onCellsEdited:De,onSearchResultsChanged:Ye,searchResults:no,onSearchValueChange:_o,searchValue:Uo,onKeyDown:qe,onKeyUp:ro,keybindings:Vo,editOnType:Wt=!0,onRowAppended:ot,onColumnAppended:nt,onColumnMoved:mt,validateCell:rt,highlightRegions:Ct,rangeSelect:je="rect",columnSelect:xe="multi",rowSelect:ce="multi",rangeSelectionBlending:Ze="exclusive",columnSelectionBlending:Sr="exclusive",rowSelectionBlending:Tr="exclusive",onDelete:Bo,onDragStart:lo,onMouseMove:io,onPaste:wt,copyHeaders:xn=!1,freezeColumns:Je=0,cellActivationBehavior:so="second-click",rowSelectionMode:Xo="auto",columnSelectionMode:Kt="auto",onHeaderMenuClick:co,onHeaderIndicatorClick:ao,getGroupDetails:uo,rowGrouping:lt,onSearchClose:Yo,onItemHovered:fo,onSelectionCleared:it,showSearch:zr,onVisibleRegionChanged:ho,gridSelection:pt,onGridSelectionChange:qo,minColumnWidth:Er=50,maxColumnWidth:Lr=500,maxColumnAutoWidth:Ir,provideEditor:Hr,trailingRowOptions:V,freezeTrailingRows:Qe=0,allowedFillDirections:Mn="orthogonal",scrollOffsetX:Dr,scrollOffsetY:$r,verticalBorder:zt,onDragOverCell:Fr,onDrop:Ar,onColumnResize:_t,onColumnResizeEnd:Ut,onColumnResizeStart:Vt,customRenderers:go,fillHandle:Gr,experimental:ue,fixedShadowX:Pr,fixedShadowY:Nr,headerIcons:Or,imageWindowLoader:Wr,initialSize:Kr,isDraggable:_r,onDragLeave:Ur,onRowMoved:Bt,overscrollX:Vr,overscrollY:Br,preventDiagonalScrolling:Xr,rightElement:Yr,rightElementProps:qr,trapFocus:Rn=!1,smoothScrollX:jr,smoothScrollY:Zr,scaleToRem:Jr=!1,rowHeight:Qr=34,headerHeight:kn=36,groupHeaderHeight:el=kn,theme:tl,isOutsideClick:ol,renderers:jo,resizeIndicator:nl,scrollToActiveCell:Sn=!0,drawFocusRing:Tn=!0,portalElementRef:rl}=e,zn=Tn==="no-editor"?m===void 0:Tn,te=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Pe=(te==null?void 0:te.kind)??e.rowMarkers??"none",ll=(te==null?void 0:te.width)??e.rowMarkerWidth,En=(te==null?void 0:te.startIndex)??e.rowMarkerStartIndex??1,Ln=(te==null?void 0:te.theme)??e.rowMarkerTheme,In=te==null?void 0:te.headerTheme,Hn=te==null?void 0:te.headerAlwaysVisible,vo=ce!=="multi"||(te==null?void 0:te.headerDisabled)===!0,mo=(te==null?void 0:te.checkboxStyle)??"square",Et=Math.max(Er,20),Co=Math.max(Lr,Et),il=Math.max(Ir??Co,Et),Dn=i.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:D,rowNumberMapper:$n,rowHeight:sl,getRowThemeOverride:et}=Mc(lt,L,Qr,N),cl=i.useMemo(()=>Number.parseFloat(Dn.fontSize),[Dn]),{rowHeight:st,headerHeight:Fn,groupHeaderHeight:wo,theme:An,overscrollX:al,overscrollY:ul}=bc({groupHeaderHeight:el,headerHeight:kn,overscrollX:Vr,overscrollY:Br,remSize:cl,rowHeight:sl,scaleToRem:Jr,theme:tl}),ct=yc(Vo),Lt=ll??(L>1e4?48:L>1e3?44:L>100?36:32),Ue=Pe!=="none",a=Ue?1:0,ie=V!==void 0,Xt=(V==null?void 0:V.sticky)===!0,[dl,Gn]=i.useState(!1),fl=zr??dl,hl=i.useCallback(()=>{Yo!==void 0?Yo():Gn(!1)},[Yo]),h=i.useMemo(()=>pt===void 0?void 0:Po(pt,a),[pt,a])??l,Se=i.useRef(void 0);Se.current===void 0&&(Se.current=new AbortController),i.useEffect(()=>()=>Se==null?void 0:Se.current.abort(),[]);const[ve,gl]=fc(F,O,a,Se.current,D),vl=i.useCallback((t,n,r)=>{if(rt===void 0)return!0;const s=[t[0]-a,t[1]];return rt==null?void 0:rt(s,n,r)},[a,rt]),po=i.useRef(pt),$e=i.useCallback((t,n)=>{n&&(t=di(t,ve,a,vt,Se.current)),qo!==void 0?(po.current=Po(t,-a),qo(po.current)):c(t)},[qo,ve,a,vt]),It=gt(_t,i.useCallback((t,n,r,s)=>{_t==null||_t(U[r-a],n,r-a,s)},[_t,a,U])),ml=gt(Ut,i.useCallback((t,n,r,s)=>{Ut==null||Ut(U[r-a],n,r-a,s)},[Ut,a,U])),Cl=gt(Vt,i.useCallback((t,n,r,s)=>{Vt==null||Vt(U[r-a],n,r-a,s)},[Vt,a,U])),wl=gt(ne,i.useCallback((t,n)=>(ne==null?void 0:ne({...t,columnIndex:t.columnIndex-a},n))??!1,[ne,a])),pl=gt(ze,i.useCallback((t,n)=>(ze==null?void 0:ze({...t,col:t.col-a},n))??!1,[ze,a])),at=i.useCallback(t=>{if(Bo!==void 0){const n=Bo(Po(t,-a));return typeof n=="boolean"?n:Po(n,a)}return!0},[Bo,a]),[me,Me,de]=dc(h,$e,Ze,Sr,Tr,je,Tt),pe=i.useMemo(()=>gn(wr(),An),[An]),[Zo,bl]=i.useState([0,0,0]),Pn=i.useMemo(()=>{if(jo===void 0)return{};const t={};for(const n of jo)t[n.kind]=n;return t},[jo]),Re=i.useCallback(t=>t.kind!==Z.Custom?Pn[t.kind]:go==null?void 0:go.find(n=>n.isMatch(t)),[go,Pn]);let{sizedColumns:Ee,nonGrowWidth:Nn}=Di(U,D,gl,Zo[0]-(a===0?0:Lt)-Zo[2],Et,il,pe,Re,Se.current);Pe!=="none"&&(Nn+=Lt);const Jo=i.useMemo(()=>Ee.some(t=>t.group!==void 0),[Ee]),yl=Jo?Array.isArray(wo)?wo.reduce((t,n)=>t+n,0):wo:0,Yt=Fn+yl,On=h.rows.length,Wn=Pe==="none"?void 0:On===0?!1:On===D?!0:void 0,W=i.useMemo(()=>Pe==="none"?Ee:[{title:"",width:Lt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ln,rowMarker:mo,rowMarkerChecked:Wn,headerRowMarkerTheme:In,headerRowMarkerAlwaysVisible:Hn,headerRowMarkerDisabled:vo},...Ee],[Pe,Ee,Lt,Ln,mo,Wn,In,Hn,vo]),Le=i.useRef({height:1,width:1,x:0,y:0}),bo=i.useRef(!1),{setVisibleRegion:Kn,visibleRegion:bt,scrollRef:q}=Sc(Dr,$r,st,Le,()=>bo.current=!0);Le.current=bt;const xl=bt.x+a,yo=bt.y,fe=i.useRef(null),ke=i.useCallback(t=>{var n;t===!0?(n=fe.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=fe.current)==null||r.focus()})},[]),be=ie?D+1:D,Fe=i.useCallback(t=>{const n=a===0?t:t.map(s=>({...s,location:[s.location[0]-a,s.location[1]]})),r=De==null?void 0:De(n);if(r!==!0)for(const s of n)He==null||He(s.location,s.value);return r},[He,De,a]),[yt,Qo]=i.useState(),xo=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,Ht=zn?(or=h.current)==null?void 0:or.cell:void 0,Mo=Ht==null?void 0:Ht[0],Ro=Ht==null?void 0:Ht[1],Ml=i.useMemo(()=>{if((Ct===void 0||Ct.length===0)&&(xo??Mo??Ro??yt)===void 0)return;const t=[];if(Ct!==void 0)for(const n of Ct){const r=W.length-n.range.x-a;r>0&&t.push({color:n.color,range:{...n.range,x:n.range.x+a,width:Math.min(r,n.range.width)},style:n.style})}return yt!==void 0&&t.push({color:ir(pe.accentColor,0),range:yt,style:"dashed"}),xo!==void 0&&t.push({color:ir(pe.accentColor,.5),range:xo,style:"solid-outline"}),Mo!==void 0&&Ro!==void 0&&t.push({color:pe.accentColor,range:{x:Mo,y:Ro,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0},[yt,xo,Mo,Ro,Ct,W.length,pe.accentColor,a]),_n=i.useRef(W);_n.current=W;const Ie=i.useCallback(([t,n],r=!1)=>{var C,d,f,g,w,x,k;const s=ie&&n===be-1;if(t===0&&Ue){if(s)return No;const b=$n(n);return b===void 0?No:{kind:Ao.Marker,allowOverlay:!1,checkboxStyle:mo,checked:(h==null?void 0:h.rows.hasIndex(n))===!0,markerKind:Pe==="clickable-number"?"number":Pe,row:En+b,drawHandle:Bt!==void 0,cursor:Pe==="clickable-number"?"pointer":void 0}}else if(s){const H=t===a?(V==null?void 0:V.hint)??"":"",T=_n.current[t];if(((C=T==null?void 0:T.trailingRowOptions)==null?void 0:C.disabled)===!0)return No;{const A=((d=T==null?void 0:T.trailingRowOptions)==null?void 0:d.hint)??H,$=((f=T==null?void 0:T.trailingRowOptions)==null?void 0:f.addIcon)??(V==null?void 0:V.addIcon);return{kind:Ao.NewRow,hint:A,allowOverlay:!1,icon:$}}}else{const b=t-a;if(r||(ue==null?void 0:ue.strict)===!0){const T=Le.current,A=T.x>b||b>T.x+T.width||T.y>n||n>T.y+T.height||n>=nn.current,$=b===((w=(g=T.extras)==null?void 0:g.selected)==null?void 0:w[0])&&n===((x=T.extras)==null?void 0:x.selected[1]);let I=!1;if(((k=T.extras)==null?void 0:k.freezeRegions)!==void 0){for(const K of T.extras.freezeRegions)if(fi(K,b,n)){I=!0;break}}if(A&&!$&&!I)return No}let H=O([b,n]);return a!==0&&H.span!==void 0&&(H={...H,span:[H.span[0]+a,H.span[1]+a]}),H}},[ie,be,Ue,$n,mo,h==null?void 0:h.rows,Pe,En,Bt,a,V==null?void 0:V.hint,V==null?void 0:V.addIcon,ue==null?void 0:ue.strict,O]),en=i.useCallback(t=>{let n=(uo==null?void 0:uo(t))??{name:t};return se!==void 0&&t!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>ln({group:n.name,bounds:r.bounds})}]}),n},[uo,se]),ko=i.useCallback(t=>{var g;const[n,r]=t.cell,s=W[n],u=(s==null?void 0:s.group)!==void 0?Array.isArray(s.group)?s.group[0]??"":s.group:"",C=u!==""?(g=en(u))==null?void 0:g.overrideTheme:void 0,d=s==null?void 0:s.themeOverride,f=et==null?void 0:et(r);y({...t,theme:gn(pe,C,d,f,t.content.themeOverride)})},[et,W,en,pe]),Dt=i.useCallback((t,n,r)=>{var d;if(h.current===void 0)return;const[s,u]=h.current.cell,C=Ie([s,u]);if(C.kind!==Z.Boolean&&C.allowOverlay){let f=C;if(r!==void 0)switch(f.kind){case Z.Number:{const g=hi(()=>r==="-"?-0:Number.parseFloat(r),0);f={...f,data:Number.isNaN(g)?0:g};break}case Z.Text:case Z.Markdown:case Z.Uri:f={...f,data:r};break}ko({target:t,content:f,initialValue:r,cell:[s,u],highlight:r===void 0,forceEditMode:r!==void 0,activation:n})}else C.kind===Z.Boolean&&n.inputType==="keyboard"&&C.readonly!==!0&&(Fe([{location:h.current.cell,value:{...C,data:gi(C.data)}}]),(d=fe.current)==null||d.damage([{cell:h.current.cell}]))},[Ie,h,Fe,ko]),Un=i.useCallback((t,n)=>{var u;const r=(u=fe.current)==null?void 0:u.getBounds(t,n);if(r===void 0||q.current===null)return;const s=Ie([t,n]);s.allowOverlay&&ko({target:r,content:s,initialValue:void 0,highlight:!0,cell:[t,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Ie,q,ko]),le=i.useCallback((t,n,r="both",s=0,u=0,C=void 0)=>{if(q.current!==null){const d=fe.current,f=p.current,g=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,w=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,x=typeof t!="number"&&t.unit==="px"?t.amount:void 0,k=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(d!==null&&f!==null){let b={x:0,y:0,width:0,height:0},H=0,T=0;if((g!==void 0||w!==void 0)&&(b=d.getBounds((g??0)+a,w??0)??b,b.width===0||b.height===0))return;const A=f.getBoundingClientRect(),$=A.width/f.offsetWidth;if(x!==void 0&&(b={...b,x:x-A.left-q.current.scrollLeft,width:1}),k!==void 0&&(b={...b,y:k+A.top-q.current.scrollTop,height:1}),b!==void 0){const I={x:b.x-s,y:b.y-u,width:b.width+2*s,height:b.height+2*u};let K=0;for(let fn=0;fn<Je;fn++)K+=Ee[fn].width;let oe=0;const ae=Qe+(Xt?1:0);ae>0&&(oe=vi(be,ae,st));let Te=K*$+A.left+a*Lt*$,Be=A.right,We=A.top+Yt*$,Xe=A.bottom-oe*$;const Do=b.width+s*2;switch(C==null?void 0:C.hAlign){case"start":Be=Te+Do;break;case"end":Te=Be-Do;break;case"center":Te=Math.floor((Te+Be)/2)-Do/2,Be=Te+Do;break}const $o=b.height+u*2;switch(C==null?void 0:C.vAlign){case"start":Xe=We+$o;break;case"end":We=Xe-$o;break;case"center":We=Math.floor((We+Xe)/2)-$o/2,Xe=We+$o;break}Te>I.x?H=I.x-Te:Be<I.x+I.width&&(H=I.x+I.width-Be),We>I.y?T=I.y-We:Xe<I.y+I.height&&(T=I.y+I.height-Xe),r==="vertical"||typeof t=="number"&&t<Je?H=0:(r==="horizontal"||typeof n=="number"&&n>=be-ae)&&(T=0),(H!==0||T!==0)&&($!==1&&(H/=$,T/=$),q.current.scrollTo({left:H+q.current.scrollLeft,top:T+q.current.scrollTop,behavior:(C==null?void 0:C.behavior)??"auto"}))}}}},[a,Qe,Lt,q,Yt,Je,Ee,be,Xt,st]),tn=i.useRef(Un),on=i.useRef(O);tn.current=Un,on.current=O;const nn=i.useRef(D);nn.current=D;const Vn=i.useRef(W.length);Vn.current=W.length;const ut=i.useCallback(async(t,n=!0,r)=>{var w;const s=W[t];if(((w=s==null?void 0:s.trailingRowOptions)==null?void 0:w.disabled)===!0)return;const u=ot==null?void 0:ot();let C,d=!0;u!==void 0&&(C=await u,C==="top"&&(d=!1),typeof C=="number"&&(d=!1));let f=0;const g=()=>{if(nn.current<=D){f<500&&window.setTimeout(g,f),f=50+f*2;return}const x=typeof C=="number"?C:d?D:0;Ho.current(t-a,x,"both",0,0,r?{behavior:r}:void 0),me({cell:[t,x],range:{x:t,y:x,width:1,height:1}},!1,!1,"edit");const k=on.current([t-a,x]);k.allowOverlay&&to(k)&&k.readonly!==!0&&n&&window.setTimeout(()=>{tn.current(t,x)},0)};g()},[W,ot,a,D,me]),So=i.useCallback(async(t,n=!0)=>{const r=nt==null?void 0:nt();let s,u=!0;r!==void 0&&(s=await r,s==="left"&&(u=!1),typeof s=="number"&&(u=!1));let C=0;const d=()=>{if(Vn.current<=W.length){C<500&&window.setTimeout(d,C),C=50+C*2;return}const f=typeof s=="number"?s:u?W.length:0;le(f-a,t),me({cell:[f,t],range:{x:f,y:t,width:1,height:1}},!1,!1,"edit");const g=on.current([f-a,t]);g.allowOverlay&&to(g)&&g.readonly!==!0&&n&&window.setTimeout(()=>{tn.current(f,t)},0)};d()},[W,nt,a,le,me]),$t=i.useCallback(t=>{var r,s;const n=((s=(r=Ee[t])==null?void 0:r.trailingRowOptions)==null?void 0:s.targetColumn)??(V==null?void 0:V.targetColumn);if(typeof n=="number")return n+(Ue?1:0);if(typeof n=="object"){const u=U.indexOf(n);if(u>=0)return u+(Ue?1:0)}},[Ee,U,Ue,V==null?void 0:V.targetColumn]),dt=i.useRef(void 0),Ft=i.useRef(void 0),qt=i.useCallback((t,n)=>{var u;const[r,s]=n;return gn(pe,(u=W[r])==null?void 0:u.themeOverride,et==null?void 0:et(s),t.themeOverride)},[et,W,pe]),{mapper:xt}=Rc(lt,L),Ne=lt==null?void 0:lt.navigationBehavior,jt=i.useCallback(t=>{var w,x,k;const n=Ko.value?t.metaKey:t.ctrlKey,r=n&&ce==="multi",[s,u]=t.location,C=h.columns,d=h.rows,[f,g]=((w=h.current)==null?void 0:w.cell)??[];if(t.kind==="cell"){if(Ft.current=void 0,Mt.current=[s,u],s===0&&Ue){if(ie===!0&&u===D||Pe==="number"||ce==="none")return;const b=Ie(t.location);if(b.kind!==Ao.Marker)return;if(Bt!==void 0){const A=Re(b);Wo((A==null?void 0:A.kind)===Ao.Marker);const $=(x=A==null?void 0:A.onClick)==null?void 0:x.call(A,{...t,cell:b,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:qt(b,t.location),preventDefault:()=>{}});if($===void 0||$.checked===b.checked)return}y(void 0),ke();const H=d.hasIndex(u),T=dt.current;if(ce==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&T!==void 0&&d.hasIndex(T)){const A=[Math.min(T,u),Math.max(T,u)+1];r||Xo==="multi"?Me(void 0,A,!0):Me(Y.fromSingleSelection(A),void 0,r)}else ce==="multi"&&(r||t.isTouch||Xo==="multi")?H?Me(d.remove(u),void 0,!0):(Me(void 0,u,!0),dt.current=u):H&&d.length===1?Me(Y.empty(),void 0,n):(Me(Y.fromSingleSelection(u),void 0,n),dt.current=u)}else if(s>=a&&ie&&u===D){const b=$t(s);ut(b??s)}else if(f!==s||g!==u){const b=Ie(t.location),H=Re(b);if((H==null?void 0:H.onSelect)!==void 0){let $=!1;if(H.onSelect({...t,cell:b,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>$=!0,theme:qt(b,t.location)}),$)return}if(Ne==="block"&&xt(u).isGroupHeader)return;const T=Xt&&u===D,A=Xt&&h!==void 0&&((k=h.current)==null?void 0:k.cell[1])===D;if((t.shiftKey||t.isLongTouch===!0)&&f!==void 0&&g!==void 0&&h.current!==void 0&&!A){if(T)return;const $=Math.min(s,f),I=Math.max(s,f),K=Math.min(u,g),oe=Math.max(u,g);me({...h.current,range:{x:$,y:K,width:I-$+1,height:oe-K+1}},!0,n,"click"),dt.current=void 0,ke()}else me({cell:[s,u],range:{x:s,y:u,width:1,height:1}},!0,n,"click"),dt.current=void 0,y(void 0),ke()}}else if(t.kind==="header")if(Mt.current=[s,u],y(void 0),Ue&&s===0)dt.current=void 0,Ft.current=void 0,!vo&&ce==="multi"&&(d.length!==D?Me(Y.fromSingleSelection([0,D]),void 0,n):Me(Y.empty(),void 0,n),ke());else{const b=Ft.current;if(xe==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&b!==void 0&&C.hasIndex(b)){const H=[Math.min(b,s),Math.max(b,s)+1];n||t.isTouch||Kt==="multi"?de(void 0,H,n):de(Y.fromSingleSelection(H),void 0,n)}else xe==="multi"&&(n||t.isTouch||Kt==="multi")?(C.hasIndex(s)?de(C.remove(s),void 0,n):de(void 0,s,n),Ft.current=s):xe!=="none"&&(C.hasIndex(s)?de(C.remove(s),void 0,n):de(Y.fromSingleSelection(s),void 0,n),Ft.current=s);dt.current=void 0,ke()}else t.kind===Pt?Mt.current=[s,u]:t.kind===sr&&!t.isMaybeScrollbar&&($e(Oo,!1),y(void 0),ke(),it==null||it(),dt.current=void 0,Ft.current=void 0)},[ce,xe,h,Ue,a,ie,D,Pe,Ie,Bt,ke,Xo,Kt,Re,qt,Me,$t,ut,Ne,xt,Xt,me,vo,de,$e,it]),Zt=i.useRef(!1),Mt=i.useRef(void 0),Bn=i.useRef(bt),Ae=i.useRef(void 0),Rl=i.useCallback(t=>{if(At.current=!1,Bn.current=Le.current,t.button!==0&&t.button!==1){Ae.current=void 0;return}const n=performance.now();Ae.current={button:t.button,time:n,location:t.location},(t==null?void 0:t.kind)==="header"&&(Zt.current=!0);const r=t.kind==="cell"&&t.isFillHandle;!r&&t.kind!=="cell"&&t.isEdge||(E({previousSelection:h,fillHandle:r}),Mt.current=void 0,!t.isTouch&&t.button===0&&!r?jt(t):!t.isTouch&&t.button===1&&(Mt.current=t.location))},[h,jt]),[rn,ln]=i.useState(),Xn=i.useCallback(t=>{if(t.kind!==Pt||xe!=="multi")return;const n=Ko.value?t.metaKey:t.ctrlKey,[r,s]=t.location,u=h.columns;if(r<a)return;const C=s<=-2?-2-s:0,d=W[r];let f=r,g=r;for(let w=r-1;w>=a;w--){let x=!0;for(let k=0;k<=C;k++)if(!cr(d.group,W[w].group,k)){x=!1;break}if(!x)break;f--}for(let w=r+1;w<W.length;w++){let x=!0;for(let k=0;k<=C;k++)if(!cr(d.group,W[w].group,k)){x=!1;break}if(!x)break;g++}if(ke(),n||t.isTouch||Kt==="multi")if(u.hasAll([f,g+1])){let w=u;for(let x=f;x<=g;x++)w=w.remove(x);de(w,void 0,n)}else de(void 0,[f,g+1],n);else de(Y.fromSingleSelection([f,g+1]),void 0,n)},[xe,ke,h.columns,W,a,de,Kt]),At=i.useRef(!1),To=i.useCallback(async t=>{if(ve!==void 0&&It!==void 0){const n=Le.current.y,r=Le.current.height;let s=ve({x:t,y:n,width:1,height:Math.min(r,D-n)},Se.current.signal);typeof s!="object"&&(s=await s());const u=Ee[t-a],d=document.createElement("canvas").getContext("2d",{alpha:!1});if(d!==null){d.font=pe.baseFontFull;const f=pr(d,pe,u,0,s,Et,Co,!1,Re);It==null||It(u,f.width,t,f.width)}}},[Ee,ve,Co,pe,Et,It,a,D,Re]),[kl,zo]=i.useState(),Gt=i.useCallback(async(t,n)=>{var f,g;const r=(f=t.current)==null?void 0:f.range;if(r===void 0||ve===void 0||n.current===void 0)return;const s=n.current.range;if(ge!==void 0){let w=!1;if(ge({fillDestination:{...s,x:s.x-a},patternSource:{...r,x:r.x-a},preventDefault:()=>w=!0}),w)return}let u=ve(r,Se.current.signal);typeof u!="object"&&(u=await u());const C=u,d=[];for(let w=0;w<s.width;w++)for(let x=0;x<s.height;x++){const k=[s.x+w,s.y+x];if(mi(k,r))continue;const b=C[x%r.height][w%r.width];Go(b)||!to(b)||d.push({location:k,value:{...b}})}Fe(d),(g=fe.current)==null||g.damage(d.map(w=>({cell:w.location})))},[ve,Fe,ge,a]),Yn=i.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const t={...h,current:{...h.current,range:{...h.current.range,width:1}}};Gt(t,h)},[Gt,h]),qn=i.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const t={...h,current:{...h.current,range:{...h.current.range,height:1}}};Gt(t,h)},[Gt,h]),Sl=i.useCallback((t,n)=>{var x,k;const r=R;if(E(void 0),Qo(void 0),zo(void 0),Zt.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&h.current!==void 0&&((x=r.previousSelection)==null?void 0:x.current)!==void 0){if(yt===void 0)return;const b={...h,current:{...h.current,range:Ci(r.previousSelection.current.range,yt)}};Gt(r.previousSelection,b),$e(b,!0);return}const[s,u]=t.location,[C,d]=Mt.current??[],f=()=>{At.current=!0},g=b=>{var T,A,$;const H=b.isTouch||C===s&&d===u;if(H&&(ye==null||ye([s-a,u],{...b,preventDefault:f})),b.button===1)return!At.current;if(!At.current){const I=Ie(t.location),K=Re(I);if(K!==void 0&&K.onClick!==void 0&&H){const ae=K.onClick({...b,cell:I,posX:b.localEventX,posY:b.localEventY,bounds:b.bounds,theme:qt(I,t.location),preventDefault:f});ae!==void 0&&!Go(ae)&&oo(ae)&&(Fe([{location:b.location,value:ae}]),(T=fe.current)==null||T.damage([{cell:b.location}]))}if(At.current||h.current===void 0)return!1;let oe=!1;switch(I.activationBehaviorOverride??so){case"double-click":case"second-click":{if((($=(A=r==null?void 0:r.previousSelection)==null?void 0:A.current)==null?void 0:$.cell)===void 0)break;const[ae,Te]=h.current.cell,[Be,We]=r.previousSelection.current.cell;oe=s===ae&&s===Be&&u===Te&&u===We&&(b.isDoubleClick===!0||so==="second-click");break}case"single-click":{oe=!0;break}}if(oe){const Te={inputType:"pointer",pointerActivation:b.isDoubleClick===!0?"double-click":I.activationBehaviorOverride??so,pointerType:b.isTouch?"touch":"mouse"};return J==null||J([s-a,u],Te),Dt(b.bounds,Te),!0}}return!1},w=t.location[0]-a;if(t.isTouch){const b=Le.current,H=Bn.current;if(b.x!==H.x||b.y!==H.y)return;if(t.isLongTouch===!0){if(t.kind==="cell"&&wi((k=h.current)==null?void 0:k.cell,t.location)){Ge==null||Ge([w,t.location[1]],{...t,preventDefault:f});return}else if(t.kind==="header"&&h.columns.hasIndex(s)){_e==null||_e(w,{...t,preventDefault:f});return}else if(t.kind===Pt){if(w<0)return;re==null||re(w,{...t,preventDefault:f});return}}t.kind==="cell"?g(t)||jt(t):t.kind===Pt?Ke==null||Ke(w,{...t,preventDefault:f}):(t.kind===pi&&(we==null||we(w,{...t,preventDefault:f})),jt(t));return}if(t.kind==="header"){if(w<0)return;t.isEdge?t.isDoubleClick===!0&&To(s):t.button===0&&s===C&&u===d&&(we==null||we(w,{...t,preventDefault:f}))}if(t.kind===Pt){if(w<0)return;t.button===0&&s===C&&u===d&&(Ke==null||Ke(w,{...t,preventDefault:f}),At.current||Xn(t))}t.kind==="cell"&&(t.button===0||t.button===1)&&g(t),Mt.current=void 0},[R,h,a,yt,Gt,$e,ye,Ie,Re,so,qt,Fe,J,Dt,Ge,_e,re,jt,Ke,we,To,Xn]),Tl=i.useCallback(t=>{const n={...t,location:[t.location[0]-a,t.location[1]]};io==null||io(n),R!==void 0&&t.buttons===0&&(E(void 0),Qo(void 0),zo(void 0),Zt.current=!1),zo(r=>{var s;return Zt.current?[t.scrollEdge[0],0]:t.scrollEdge[0]===(r==null?void 0:r[0])&&t.scrollEdge[1]===r[1]?r:R===void 0||(((s=Ae.current)==null?void 0:s.location[0])??0)<a?void 0:t.scrollEdge})},[R,io,a]),zl=i.useCallback((t,n)=>{co==null||co(t-a,n)},[co,a]),El=i.useCallback((t,n)=>{ao==null||ao(t-a,n)},[ao,a]),Ve=(nr=h==null?void 0:h.current)==null?void 0:nr.cell,Ll=i.useCallback((t,n,r,s,u,C)=>{bo.current=!1;let d=Ve;d!==void 0&&(d=[d[0]-a,d[1]]);const f=Je===0?void 0:{x:0,y:t.y,width:Je,height:t.height},g=[];f!==void 0&&g.push(f),Qe>0&&(g.push({x:t.x-a,y:D-Qe,width:t.width,height:Qe}),Je>0&&g.push({x:0,y:D-Qe,width:Je,height:Qe}));const w={x:t.x-a,y:t.y,width:t.width,height:ie&&t.y+t.height>=D?t.height-1:t.height,tx:u,ty:C,extras:{selected:d,freezeRegion:f,freezeRegions:g}};Le.current=w,Kn(w),bl([n,r,s]),ho==null||ho(w,w.tx,w.ty,w.extras)},[Ve,a,ie,D,Je,Qe,Kn,ho]),Il=gt(tt,i.useCallback((t,n)=>(tt==null?void 0:tt(t-a,n-a))!==!1,[tt,a])),Hl=gt(mt,i.useCallback((t,n)=>{mt==null||mt(t-a,n-a),xe!=="none"&&de(Y.fromSingleSelection(n),void 0,!0)},[xe,mt,a,de])),sn=i.useRef(!1),Dl=i.useCallback(t=>{if(t.location[0]===0&&a>0){t.preventDefault();return}lo==null||lo({...t,location:[t.location[0]-a,t.location[1]]}),t.defaultPrevented()||(sn.current=!0),E(void 0)},[lo,a]),$l=i.useCallback(()=>{sn.current=!1},[]),jn=lt==null?void 0:lt.selectionBehavior,Eo=i.useCallback(t=>{if(jn!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:s}=xt(t);if(n)return[t,t];const u=r[r.length-1],C=t-u,d=t+s-u-1;return[C,d]},[xt,jn]),cn=i.useRef(void 0),an=i.useCallback(t=>{var n,r,s;if(!bi(t,cn.current)&&(cn.current=t,!(((n=Ae==null?void 0:Ae.current)==null?void 0:n.button)!==void 0&&Ae.current.button>=1))){if(t.buttons!==0&&R!==void 0&&((r=Ae.current)==null?void 0:r.location[0])===0&&a===1&&ce==="multi"&&R.previousSelection&&!R.previousSelection.rows.hasIndex(Ae.current.location[1])&&h.rows.hasIndex(Ae.current.location[1])){const u=Math.min(Ae.current.location[1],t.location[1]),C=Math.max(Ae.current.location[1],t.location[1])+1;Me(Y.fromSingleSelection([u,C]),void 0,!1)}else if(t.buttons!==0&&R!==void 0&&h.current!==void 0&&!sn.current&&!Zt.current&&(je==="rect"||je==="multi-rect")){const[u,C]=h.current.cell;let[d,f]=t.location;if(f<0&&(f=Le.current.y),R.fillHandle===!0&&((s=R.previousSelection)==null?void 0:s.current)!==void 0){const g=R.previousSelection.current.range;f=Math.min(f,ie?D-1:D);const w=yi(g,d,f,Mn);Qo(w)}else{if(ie&&C===D)return;if(ie&&f===D)if(t.kind===sr)f--;else return;d=Math.max(d,a);const x=Eo(C);f=x===void 0?f:kt(f,x[0],x[1]);const k=d-u,b=f-C,H={x:k>=0?u:d,y:b>=0?C:f,width:Math.abs(k)+1,height:Math.abs(b)+1};me({...h.current,range:H},!0,!1,"drag")}}fo==null||fo({...t,location:[t.location[0]-a,t.location[1]]})}},[R,a,ce,h,je,fo,Me,ie,D,Mn,Eo,me]),Fl=i.useCallback(()=>{var d,f;const t=cn.current;if(t===void 0)return;const[n,r]=t.scrollEdge;let[s,u]=t.location;const C=Le.current;n===-1?s=((f=(d=C.extras)==null?void 0:d.freezeRegion)==null?void 0:f.x)??C.x:n===1&&(s=C.x+C.width),r===-1?u=Math.max(0,C.y):r===1&&(u=Math.min(D-1,C.y+C.height)),s=kt(s,0,W.length-1),u=kt(u,0,D-1),an({...t,location:[s,u]})},[W.length,an,D]);pc(kl,q,Fl);const Oe=i.useCallback(t=>{if(h.current===void 0)return;const[n,r]=t,[s,u]=h.current.cell,C=h.current.range;let d=C.x,f=C.x+C.width,g=C.y,w=C.y+C.height;const[x,k]=Eo(u)??[0,D-1],b=k+1;if(r!==0)switch(r){case 2:{w=b,g=u,le(0,w,"vertical");break}case-2:{g=x,w=u+1,le(0,g,"vertical");break}case 1:{g<u?(g++,le(0,g,"vertical")):(w=Math.min(b,w+1),le(0,w,"vertical"));break}case-1:{w>u+1?(w--,le(0,w,"vertical")):(g=Math.max(x,g-1),le(0,g,"vertical"));break}default:ar()}if(n!==0)if(n===2)f=W.length,d=s,le(f-1-a,0,"horizontal");else if(n===-2)d=a,f=s+1,le(d-a,0,"horizontal");else{let H=[];if(ve!==void 0){const T=ve({x:d,y:g,width:f-d-a,height:w-g},Se.current.signal);typeof T=="object"&&(H=Ec(T))}if(n===1){let T=!1;if(d<s){if(H.length>0){const A=Nt(d+1,s+1).find($=>!H.includes($-a));A!==void 0&&(d=A,T=!0)}else d++,T=!0;T&&le(d,0,"horizontal")}T||(f=Math.min(W.length,f+1),le(f-1-a,0,"horizontal"))}else if(n===-1){let T=!1;if(f>s+1){if(H.length>0){const A=Nt(f-1,s,-1).find($=>!H.includes($-a));A!==void 0&&(f=A,T=!0)}else f--,T=!0;T&&le(f-a,0,"horizontal")}T||(d=Math.max(a,d-1),le(d-a,0,"horizontal"))}else ar()}me({cell:h.current.cell,range:{x:d,y:g,width:f-d,height:w-g}},!0,!1,"keyboard-select")},[ve,Eo,h,W.length,a,D,le,me]),un=i.useRef(Sn);un.current=Sn;const ft=i.useCallback((t,n,r,s)=>{const u=be-(r?0:1);t=kt(t,a,Ee.length-1+a),n=kt(n,0,u);const C=Ve==null?void 0:Ve[0],d=Ve==null?void 0:Ve[1];if(t===C&&n===d)return!1;if(s&&h.current!==void 0){const f=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&f.push(h.current.range),$e({...h,current:{cell:[t,n],range:{x:t,y:n,width:1,height:1},rangeStack:f}},!0)}else me({cell:[t,n],range:{x:t,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===t&&v.current[1]===n&&(v.current=void 0),un.current&&le(t-a,n),!0},[be,a,Ee.length,Ve,h,le,$e,me]),Al=i.useCallback((t,n)=>{(m==null?void 0:m.cell)!==void 0&&t!==void 0&&oo(t)&&(Fe([{location:m.cell,value:t}]),window.requestAnimationFrame(()=>{var u;(u=fe.current)==null||u.damage([{cell:m.cell}])})),ke(!0),y(void 0);const[r,s]=n;if(h.current!==void 0&&(r!==0||s!==0)){const u=h.current.cell[1]===be-1&&t!==void 0,C=h.current.cell[0]===W.length-1&&t!==void 0;let d=!0;if(u&&s===1&&ot!==void 0){d=!1;const f=h.current.cell[0]+r,g=$t(f);ut(g??f,!1)}if(C&&r===1&&nt!==void 0){d=!1;const f=h.current.cell[1]+s;So(f,!1)}d&&ft(kt(h.current.cell[0]+r,0,W.length-1),kt(h.current.cell[1]+s,0,be-1),u,!1)}X==null||X(t,n)},[m==null?void 0:m.cell,ke,h,X,Fe,be,ft,W.length,ut,So,ot,nt,$t]),Gl=i.useMemo(()=>`gdg-overlay-${zc++}`,[]),Rt=i.useCallback(t=>{var r,s,u,C;ke();const n=[];for(let d=t.x;d<t.x+t.width;d++)for(let f=t.y;f<t.y+t.height;f++){const g=O([d-a,f]);if(!g.allowOverlay&&g.kind!==Z.Boolean)continue;let w;if(g.kind===Z.Custom){const x=Re(g),k=(r=x==null?void 0:x.provideEditor)==null?void 0:r.call(x,{...g,location:[d-a,f]});(x==null?void 0:x.onDelete)!==void 0?w=x.onDelete(g):xi(k)&&(w=(s=k==null?void 0:k.deletedValue)==null?void 0:s.call(k,g))}else if(oo(g)&&g.allowOverlay||g.kind===Z.Boolean){const x=Re(g);w=(u=x==null?void 0:x.onDelete)==null?void 0:u.call(x,g)}w!==void 0&&!Go(w)&&oo(w)&&n.push({location:[d,f],value:w})}Fe(n),(C=fe.current)==null||C.damage(n.map(d=>({cell:d.location})))},[ke,O,Re,Fe,a]),Jt=m!==void 0,Zn=i.useCallback(t=>{var A,$;const n=()=>{t.stopPropagation(),t.preventDefault()},r={didMatch:!1},{bounds:s}=t,u=h.columns,C=h.rows,d=ct;if(!Jt&&G(d.clear,t,r))$e(Oo,!1),it==null||it();else if(!Jt&&G(d.selectAll,t,r))$e({columns:Y.empty(),rows:Y.empty(),current:{cell:((A=h.current)==null?void 0:A.cell)??[a,0],range:{x:a,y:0,width:U.length,height:D},rangeStack:[]}},!1);else if(G(d.search,t,r))($=z==null?void 0:z.current)==null||$.focus({preventScroll:!0}),Gn(!0);else if(G(d.delete,t,r)){const I=(at==null?void 0:at(h))??!0;if(I!==!1){const K=I===!0?h:I;if(K.current!==void 0){Rt(K.current.range);for(const oe of K.current.rangeStack)Rt(oe)}for(const oe of K.rows)Rt({x:a,y:oe,width:U.length,height:1});for(const oe of K.columns)Rt({x:oe,y:0,width:1,height:D})}}if(r.didMatch)return n(),!0;if(h.current===void 0)return!1;let[f,g]=h.current.cell;const[,w]=h.current.cell;let x=!1,k=!1;if(G(d.scrollToSelectedCell,t,r))Ho.current(f-a,g);else if(xe!=="none"&&G(d.selectColumn,t,r))u.hasIndex(f)?de(u.remove(f),void 0,!0):xe==="single"?de(Y.fromSingleSelection(f),void 0,!0):de(void 0,f,!0);else if(ce!=="none"&&G(d.selectRow,t,r))C.hasIndex(g)?Me(C.remove(g),void 0,!0):ce==="single"?Me(Y.fromSingleSelection(g),void 0,!0):Me(void 0,g,!0);else if(!Jt&&s!==void 0&&G(d.activateCell,t,r))if(g===D&&ie)window.setTimeout(()=>{const I=$t(f);ut(I??f)},0);else{const I={inputType:"keyboard",key:t.key};J==null||J([f-a,g],I),Dt(s,I)}else h.current.range.height>1&&G(d.downFill,t,r)?qn():h.current.range.width>1&&G(d.rightFill,t,r)?Yn():G(d.goToNextPage,t,r)?g+=Math.max(1,Le.current.height-4):G(d.goToPreviousPage,t,r)?g-=Math.max(1,Le.current.height-4):G(d.goToFirstCell,t,r)?(y(void 0),g=0,f=0):G(d.goToLastCell,t,r)?(y(void 0),g=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):G(d.selectToFirstCell,t,r)?(y(void 0),Oe([-2,-2])):G(d.selectToLastCell,t,r)?(y(void 0),Oe([2,2])):Jt?(G(d.closeOverlay,t,r)&&y(void 0),G(d.acceptOverlayDown,t,r)&&(y(void 0),g++),G(d.acceptOverlayUp,t,r)&&(y(void 0),g--),G(d.acceptOverlayLeft,t,r)&&(y(void 0),f--),G(d.acceptOverlayRight,t,r)&&(y(void 0),f++)):(G(d.goDownCell,t,r)?g+=1:G(d.goUpCell,t,r)?g-=1:G(d.goRightCell,t,r)?f+=1:G(d.goLeftCell,t,r)?f-=1:G(d.goDownCellRetainSelection,t,r)?(g+=1,x=!0):G(d.goUpCellRetainSelection,t,r)?(g-=1,x=!0):G(d.goRightCellRetainSelection,t,r)?(f+=1,x=!0):G(d.goLeftCellRetainSelection,t,r)?(f-=1,x=!0):G(d.goToLastRow,t,r)?g=D-1:G(d.goToFirstRow,t,r)?g=Number.MIN_SAFE_INTEGER:G(d.goToLastColumn,t,r)?f=Number.MAX_SAFE_INTEGER:G(d.goToFirstColumn,t,r)?f=Number.MIN_SAFE_INTEGER:(je==="rect"||je==="multi-rect")&&(G(d.selectGrowDown,t,r)?Oe([0,1]):G(d.selectGrowUp,t,r)?Oe([0,-1]):G(d.selectGrowRight,t,r)?Oe([1,0]):G(d.selectGrowLeft,t,r)?Oe([-1,0]):G(d.selectToLastRow,t,r)?Oe([0,2]):G(d.selectToFirstRow,t,r)?Oe([0,-2]):G(d.selectToLastColumn,t,r)?Oe([2,0]):G(d.selectToFirstColumn,t,r)&&Oe([-2,0])),k=r.didMatch);if(Ne!==void 0&&Ne!=="normal"&&g!==w){const I=Ne==="skip-up"||Ne==="skip"||Ne==="block",K=Ne==="skip-down"||Ne==="skip"||Ne==="block",oe=g<w;if(oe&&I){for(;g>=0&&xt(g).isGroupHeader;)g--;g<0&&(g=w)}else if(!oe&&K){for(;g<D&&xt(g).isGroupHeader;)g++;g>=D&&(g=w)}}const H=ft(f,g,!1,x),T=r.didMatch;return T&&(H||!k||Rn)&&n(),T},[Ne,Jt,h,ct,xe,ce,je,a,xt,D,ft,$e,it,U.length,at,Rn,Rt,de,Me,ie,$t,ut,J,Dt,qn,Yn,Oe]),Qt=i.useCallback(t=>{let n=!1;if(qe!==void 0&&qe({...t,...t.location&&{location:[t.location[0]-a,t.location[1]]},cancel:()=>{n=!0}}),n||Zn(t)||h.current===void 0)return;const[r,s]=h.current.cell,u=Le.current;if(Wt&&!t.metaKey&&!t.ctrlKey&&h.current!==void 0&&t.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(t.key)&&t.bounds!==void 0&&to(O([r-a,Math.max(0,Math.min(s,D-1))]))){if((!ie||s!==D)&&(u.y>s||s>u.y+u.height||u.x>r||r>u.x+u.width))return;const C={inputType:"keyboard",key:t.key};J==null||J([r-a,s],C),Dt(t.bounds,C,t.key),t.stopPropagation(),t.preventDefault()}},[Wt,qe,Zn,h,O,a,D,ie,J,Dt]),Pl=i.useCallback((t,n)=>{const r=t.location[0]-a;if(t.kind==="header"&&(_e==null||_e(r,{...t,preventDefault:n})),t.kind===Pt){if(r<0)return;re==null||re(r,{...t,preventDefault:n})}if(t.kind==="cell"){const[s,u]=t.location;Ge==null||Ge([r,u],{...t,preventDefault:n}),Mi(h,t.location)||ft(s,u,!1,!1)}},[h,Ge,re,_e,a,ft]),dn=i.useCallback(async t=>{var d,f,g;if(!ct.paste)return;function n(w,x,k,b){var T,A;const H=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!Go(w)&&to(w)&&w.readonly!==!0){const $=Q==null?void 0:Q(H,w);if($!==void 0&&oo($))return{location:x,value:$};const I=Re(w);if(I===void 0)return;if(I.kind===Z.Custom){Wo(w.kind===Z.Custom);const K=(T=I.onPaste)==null?void 0:T.call(I,H,w.data);return K===void 0?void 0:{location:x,value:{...w,data:K}}}else{const K=(A=I.onPaste)==null?void 0:A.call(I,H,w,{formatted:b,formattedString:typeof b=="string"?b:b==null?void 0:b.join(`
`),rawValue:k});return K===void 0?void 0:(Wo(K.kind===w.kind),{location:x,value:K})}}}const r=h.columns,s=h.rows,u=((d=q.current)==null?void 0:d.contains(document.activeElement))===!0||((f=p.current)==null?void 0:f.contains(document.activeElement))===!0;let C;if(h.current!==void 0?C=[h.current.range.x,h.current.range.y]:r.length===1?C=[r.first()??0,0]:s.length===1&&(C=[a,s.first()??0]),u&&C!==void 0){let w,x;const k="text/plain",b="text/html";if(navigator.clipboard.read!==void 0){const $=await navigator.clipboard.read();for(const I of $){if(I.types.includes(b)){const oe=await(await I.getType(b)).text(),ae=ur(oe);if(ae!==void 0){w=ae;break}}I.types.includes(k)&&(x=await(await I.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)x=await navigator.clipboard.readText();else if(t!==void 0&&(t==null?void 0:t.clipboardData)!==null){if(t.clipboardData.types.includes(b)){const $=t.clipboardData.getData(b);w=ur($)}w===void 0&&t.clipboardData.types.includes(k)&&(x=t.clipboardData.getData(k))}else return;const[H,T]=C,A=[];do{if(wt===void 0){const $=Ie(C),I=x??(w==null?void 0:w.map(oe=>oe.map(ae=>ae.rawValue).join("	")).join("	"))??"",K=n($,C,I,void 0);K!==void 0&&A.push(K);break}if(w===void 0){if(x===void 0)return;w=Ri(x)}if(wt===!1||typeof wt=="function"&&(wt==null?void 0:wt([C[0]-a,C[1]],w.map($=>$.map(I=>{var K;return((K=I.rawValue)==null?void 0:K.toString())??""}))))!==!0)return;for(const[$,I]of w.entries()){if($+T>=D)break;for(const[K,oe]of I.entries()){const ae=[K+H,$+T],[Te,Be]=ae;if(Te>=W.length||Be>=be)continue;const We=Ie(ae),Xe=n(We,ae,oe.rawValue,oe.formatted);Xe!==void 0&&A.push(Xe)}}}while(!1);Fe(A),(g=fe.current)==null||g.damage(A.map($=>({cell:$.location})))}},[Q,Re,Ie,h,ct.paste,q,W.length,Fe,be,wt,a,D]);vn("paste",dn,M,!1,!0);const eo=i.useCallback(async(t,n)=>{var d,f;if(!ct.copy)return;const r=n===!0||((d=q.current)==null?void 0:d.contains(document.activeElement))===!0||((f=p.current)==null?void 0:f.contains(document.activeElement))===!0,s=h.columns,u=h.rows,C=(g,w)=>{if(!xn)dr(g,w,t);else{const x=w.map(k=>({kind:Z.Text,data:U[k].title,displayData:U[k].title,allowOverlay:!1}));dr([x,...g],w,t)}};if(r&&ve!==void 0){if(h.current!==void 0){let g=ve(h.current.range,Se.current.signal);typeof g!="object"&&(g=await g()),C(g,Nt(h.current.range.x-a,h.current.range.x+h.current.range.width-a))}else if(u!==void 0&&u.length>0){const w=[...u].map(x=>{const k=ve({x:a,y:x,width:U.length,height:1},Se.current.signal);return typeof k=="object"?k[0]:k().then(b=>b[0])});if(w.some(x=>x instanceof Promise)){const x=await Promise.all(w);C(x,Nt(U.length))}else C(w,Nt(U.length))}else if(s.length>0){const g=[],w=[];for(const x of s){let k=ve({x,y:0,width:1,height:D},Se.current.signal);typeof k!="object"&&(k=await k()),g.push(k),w.push(x-a)}if(g.length===1)C(g[0],w);else{const x=g.reduce((k,b)=>k.map((H,T)=>[...H,...b[T]]));C(x,w)}}}},[U,ve,h,ct.copy,a,q,D,xn]);vn("copy",eo,M,!1,!1);const Nl=i.useCallback(async t=>{var r,s;if(!(!ct.cut||!(((r=q.current)==null?void 0:r.contains(document.activeElement))===!0||((s=p.current)==null?void 0:s.contains(document.activeElement))===!0))&&(await eo(t),h.current!==void 0)){let u={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:Y.empty(),columns:Y.empty()};const C=at==null?void 0:at(u);if(C===!1||(u=C===!0?u:C,u.current===void 0))return;Rt(u.current.range)}},[Rt,h,ct.cut,eo,q,at]);vn("cut",Nl,M,!1,!1);const Ol=i.useCallback((t,n)=>{if(Ye!==void 0){a!==0&&(t=t.map(u=>[u[0]-a,u[1]])),Ye(t,n);return}if(t.length===0||n===-1)return;const[r,s]=t[n];v.current!==void 0&&v.current[0]===r&&v.current[1]===s||(v.current=[r,s],ft(r,s,!1,!1))},[Ye,a,ft]),[Lo,Io]=((rr=pt==null?void 0:pt.current)==null?void 0:rr.cell)??[],Ho=i.useRef(le);Ho.current=le,i.useLayoutEffect(()=>{var t,n,r,s;un.current&&!bo.current&&Lo!==void 0&&Io!==void 0&&(Lo!==((n=(t=po.current)==null?void 0:t.current)==null?void 0:n.cell[0])||Io!==((s=(r=po.current)==null?void 0:r.current)==null?void 0:s.cell[1]))&&Ho.current(Lo,Io),bo.current=!1},[Lo,Io]);const Jn=h.current!==void 0&&(h.current.cell[0]>=W.length||h.current.cell[1]>=be);i.useLayoutEffect(()=>{Jn&&$e(Oo,!1)},[Jn,$e]);const Wl=i.useMemo(()=>ie===!0&&(V==null?void 0:V.tint)===!0?Y.fromSingleSelection(be-1):Y.empty(),[be,ie,V==null?void 0:V.tint]),Kl=i.useCallback(t=>typeof zt=="boolean"?zt:(zt==null?void 0:zt(t-a))??!0,[a,zt]),_l=i.useMemo(()=>{if(rn===void 0||p.current===null)return null;const{bounds:t,group:n}=rn,r=p.current.getBoundingClientRect();return i.createElement(ac,{bounds:t,group:n,canvasBounds:r,onClose:()=>ln(void 0),onFinish:s=>{ln(void 0),se==null||se(n,s)}})},[se,rn]),Ul=Math.min(W.length,Je+(Ue?1:0));i.useImperativeHandle(o,()=>({appendRow:(t,n)=>ut(t+a,n),appendColumn:(t,n)=>So(t,n),updateCells:t=>{var n;return a!==0&&(t=t.map(r=>({cell:[r.cell[0]+a,r.cell[1]]}))),(n=fe.current)==null?void 0:n.damage(t)},getBounds:(t,n)=>{var r;if(!((p==null?void 0:p.current)===null||(q==null?void 0:q.current)===null)){if(t===void 0&&n===void 0){const s=p.current.getBoundingClientRect(),u=s.width/q.current.clientWidth;return{x:s.x-q.current.scrollLeft*u,y:s.y-q.current.scrollTop*u,width:q.current.scrollWidth*u,height:q.current.scrollHeight*u}}return(r=fe.current)==null?void 0:r.getBounds((t??0)+a,n)}},focus:()=>{var t;return(t=fe.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":Qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Qt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await eo(void 0,!0);break;case"paste":await dn();break}},scrollTo:le,remeasureColumns:t=>{for(const n of t)To(n+a)},getMouseArgsForPosition:(t,n,r)=>{if((fe==null?void 0:fe.current)===null)return;const s=fe.current.getMouseArgsForPosition(t,n,r);if(s!==void 0)return{...s,location:[s.location[0]-a,s.location[1]]}}}),[ut,So,To,q,eo,Qt,dn,a,le]);const[Qn,er]=Ve??[],Vl=i.useCallback(t=>{const[n,r]=t;if(r===-1){xe!=="none"&&(de(Y.fromSingleSelection(n),void 0,!1),ke());return}Qn===n&&er===r||(me({cell:t,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),le(n,r))},[xe,ke,le,Qn,er,me,de]),[Bl,Xl]=i.useState(!1),tr=i.useRef(ki(t=>{Xl(t)},5)),Yl=i.useCallback(()=>{tr.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&R===void 0&&me({cell:[a,yo],range:{x:a,y:yo,width:1,height:1}},!0,!1,"keyboard-select")},[yo,h,R,a,me]),ql=i.useCallback(()=>{tr.current(!1)},[]),[jl,Zl]=i.useMemo(()=>{let t;const n=(ue==null?void 0:ue.scrollbarWidthOverride)??Si(),r=D+(ie?1:0);if(typeof st=="number")t=Yt+r*st;else{let u=0;const C=Math.min(r,10);for(let d=0;d<C;d++)u+=st(d);u=Math.floor(u/C),t=Yt+r*u}t+=n;const s=W.reduce((u,C)=>C.width+u,0)+n;return[`${Math.min(1e5,s)}px`,`${Math.min(1e5,t)}px`]},[W,ue==null?void 0:ue.scrollbarWidthOverride,st,D,ie,Yt]),Jl=i.useMemo(()=>Ti(pe),[pe]);return i.createElement(zi.Provider,{value:pe},i.createElement(mc,{style:Jl,className:Ot,inWidth:B??jl,inHeight:Ce??Zl},i.createElement(lc,{fillHandle:Gr,drawFocusRing:zn,experimental:ue,fixedShadowX:Pr,fixedShadowY:Nr,getRowThemeOverride:et,headerIcons:Or,imageWindowLoader:Wr,initialSize:Kr,isDraggable:_r,onDragLeave:Ur,onRowMoved:Bt,overscrollX:al,overscrollY:ul,preventDiagonalScrolling:Xr,rightElement:Yr,rightElementProps:qr,smoothScrollX:jr,smoothScrollY:Zr,className:Ot,enableGroups:Jo,onCanvasFocused:Yl,onCanvasBlur:ql,canvasRef:p,onContextMenu:Pl,theme:pe,cellXOffset:xl,cellYOffset:yo,accessibilityHeight:bt.height,onDragEnd:$l,columns:W,nonGrowWidth:Nn,drawHeader:wl,drawGroupHeader:ee,onColumnProposeMove:Il,drawCell:pl,disabledRows:Wl,freezeColumns:Ul,lockColumns:a,firstColAccessible:a===0,getCellContent:Ie,minColumnWidth:Et,maxColumnWidth:Co,searchInputRef:z,showSearch:fl,onSearchClose:hl,highlightRegions:Ml,getCellsForSelection:ve,getGroupDetails:en,headerHeight:Fn,isFocused:Bl,groupHeaderHeight:Jo?wo:0,freezeTrailingRows:Qe+(ie&&(V==null?void 0:V.sticky)===!0?1:0),hasAppendRow:ie,onColumnResize:It,onColumnResizeEnd:ml,onColumnResizeStart:Cl,onCellFocused:Vl,onColumnMoved:Hl,onDragStart:Dl,onHeaderMenuClick:zl,onHeaderIndicatorClick:El,onItemHovered:an,isFilling:(R==null?void 0:R.fillHandle)===!0,onMouseMove:Tl,onKeyDown:Qt,onKeyUp:ro,onMouseDown:Rl,onMouseUp:Sl,onDragOverCell:Fr,onDrop:Ar,onSearchResultsChanged:Ol,onVisibleRegionChanged:Ll,clientSize:Zo,rowHeight:st,searchResults:no,searchValue:Uo,onSearchValueChange:_o,rows:be,scrollRef:q,selection:h,translateX:bt.tx,translateY:bt.ty,verticalBorder:Kl,gridRef:fe,getCellRenderer:Re,resizeIndicator:nl,setScrollDir:zo}),_l,m!==void 0&&i.createElement(i.Suspense,{fallback:null},i.createElement(Tc,{...m,validateCell:vl,bloom:St,id:Gl,getCellRenderer:Re,className:(ue==null?void 0:ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Hr,imageEditorOverride:S,portalElementRef:rl,onFinishEditing:Al,markdownDivCreateNode:_,isOutsideClick:ol,customEventTarget:ue==null?void 0:ue.eventTarget}))))},Ic=i.forwardRef(Lc),Hc=(e,o)=>{const l=i.useMemo(()=>({...Qs,...e.headerIcons}),[e.headerIcons]),c=i.useMemo(()=>e.renderers??Ei,[e.renderers]),m=i.useMemo(()=>e.imageWindowLoader??new Li,[e.imageWindowLoader]);return i.createElement(Ic,{...e,renderers:c,headerIcons:l,ref:o,imageWindowLoader:m})},Wc=i.forwardRef(Hc);export{ic as C,Wc as D,Rc as a,ht as k,Oc as n,gs as u};
